<%version 1%>
<%description 
    <b>Data: </b>Item fields<br>
    <b>Notes: </b>This report displays a listing of items in column format.<br/>
	This recipe has been modified from the "Basic - HTML, Column" recipe to<br/> utilize new sample CSS shipped with the ALM 2009 Solution.<br>
%>
<%param 
    name="reporttitle" 
    type="String" 
    prompt="Report Title" 
    value="" 
    description="Descriptive title for your report."
%>
<%param
    name="reportheader" 
    type="MultiString" 
    prompt="Report Header" 
    value="" 
    description="Text appearing at the top of the report page."
%>
<%param
    name="reportfooter" 
    type="MultiString" 
    prompt="Report Footer" 
    value="" 
    description="Text appearing at the bottom of the report page."
%>


<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>&reporttitle</title>
	<style>
	.one{
		font-family:"微软雅黑";
		}
	</style>
    <%screenStyleSheet%>
    <%printerStyleSheet%>
	<script>
		
		
	</script>
</head>
<%dateformat%>
<%datetimeformat%>
<%sortby &sortby%>
<body>
<table class="heading">
<tr>
	<td><%logoURL%></td>
	<td class="title_white" align="right" width="100%">&reporttitle</td>
	<td>&nbsp;</td>
</tr>
</table>
<table class="white_bg">
    <tr><td></td></tr>
</table>
<table width="100%" class="heading">
    <tr><td></td></tr>
</tr>
</table>
<p class="header">&reportheader</p>
<p class="date"><%currentdate%></p>

<table border="0" cellspacing="0" cellpadding="0">
<tr>
	<td align="left"><a id="RERUNLINK"><img src="<%hosturl%>MKS_ALM_2009/refresh.gif" border="0"></a></td>
</tr>
</table>

<!-- Display issue field values -->
<%begindetail%>
<table class="detailcols fullWidth">
<tr>
	<!-- Display issue field headings -->
	<td align="center" rowspan="1"  bgcolor="#A6CAF0" ><font color="#FFFFFF" size="2px">SNO</td>
	<td align="center" rowspan="1"bgcolor="#A6CAF0"><font color="#FFFFFF" size="2px">Category</td>
	<td align="center" rowspan="1"bgcolor="#A6CAF0"><font color="#FFFFFF" size="2px">Goal</td>
	<td align="center" rowspan="1"bgcolor="#A6CAF0"><font color="#FFFFFF" size="2px">Metric</td>
	<td align="center" rowspan="1" bgcolor="#A6CAF0"><font color="#FFFFFF" size="2px">Attribute</td>
	<td align="center" rowspan="1" bgcolor="#A6CAF0"><font color="#FFFFFF" size="2px">Formula</th>
	<td align="center" rowspan="1" bgcolor="#A6CAF0"><font color="#FFFFFF" size="2px">Legends</td>
	<td align="center" rowspan="1" bgcolor="#A6CAF0"><font color="#FFFFFF" size="2px">Target Value</font></td>
	<td align="center" rowspan="1" bgcolor="#A6CAF0"><font color="#FFFFFF" size="2px">Actual Value</font></td>
	<td class = "one" align="center"  bgcolor="#5499EF"><font color="#FFFFFF" size="2px">Unit</font></td>
</tr>
	<script type="text/javascript">
		var splitSperator = "<;>";
		var splitColon ="<:>";
		var categoryAll = <%<%builtin KPI Category%>%>;//所有的Category
		var goalAll = <%<%builtin KPI Goal%>%>;//所有的Goal
		var metricAll = <%<%builtin KPI Metric%>%>;//所有的Metric
		var attributeAll = <%<%builtin KPI Attribute%>%>;//所有的Attribute
		var formulaAll = <%<%builtin KPI Formula%>%>;//所有的Formula
		var legendsAll = <%<%builtin KPI Legends%>%>;//所有的Legends
		var targetValueAll = <%<%builtin KPI Target Value%>%>;//所有的Target Value
		var actualValueAll = <%<%builtin KPI Actual Value%>%>;//所有的Actual Value, 需要根据Actual Value的值，判断是否拆分显示
		var unitAll = <%<%builtin KPI Unit%>%>;//所有的Unit
	
		var categoryList = categoryAll.split(splitSperator);
		var goalList = goalAll.split(splitSperator);
		var metricList = metricAll.split(splitSperator);
		var attributeList = attributeAll.split(splitSperator);
		var formulaList = formulaAll.split(splitSperator);
		var legendsList = legendsAll.split(splitSperator);
		var targetList = targetValueAll.split(splitSperator);
		var actualList = actualValueAll.split(splitSperator);
		var unitList = unitAll.split(splitSperator);
		for(var index=0; index<categoryList.length; index++){
			var singleCategory = categoryList[index];
			var snoCategory = singleCategory.split(splitColon);
			var SNO = snoCategory[0];
			var category = snoCategory[1];
			var snoGoal = goalList[index].split(splitColon);
			var goal = snoGoal[1];
			var snoMetric = metricList[index].split(splitColon);
			var metric = snoMetric[1];
			var snoAttribute = attributeList[index].split(splitColon);
			var attribute = snoAttribute[1];
			var snoFormula = formulaList[index].split(splitColon);
			var formula = snoFormula[1];
			var snoLegends = legendsList[index].split(splitColon);
			var legends = snoLegends[1];
			var snoTarget = targetList[index].split(splitColon);
			var target = snoTarget[1];
			var snoActual = actualList[index].split(splitColon);
			var actual = snoActual[1];
			var snoUnit = unitList[index].split(splitColon);
			var unit = snoUnit[1];
		}
	</script>
 </table>

<%enddetail%>

<center class="footer">&reportfooter</center>

<script type="text/javascript">
	if (REPORT_ISSUES == "") document.all.RERUNLINK.href = "<%hosturl%>im/runreport?selection=&currentReportName";
	else document.all.RERUNLINK.href = "<%hosturl%>im/runreport?selection=&currentReportName&issues=" + REPORT_ISSUES;
</script>
</body>
</html>
