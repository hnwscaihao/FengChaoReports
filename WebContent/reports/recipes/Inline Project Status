<%version 1%>
<%description
    <b>Data: </b>Project Status<br>
    <b>Notes: </b>This report displays project status.<br>
%>
<%param 
    name="reporttitle" 
    type="String" 
    prompt="Report Title" 
    value="Inline Project Status" 
    description="Descriptive title for your report."
%>
<%param
    name="reportheader" 
    type="MultiString" 
    prompt="Report Header" 
    value="" 
    description="Text appearing at the top of the report page."
%>
<%param
    name="reportfooter" 
    type="MultiString" 
    prompt="Report Footer" 
    value="" 
    description="Text appearing at the bottom of the report page."
%>

<html>
<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>&reporttitle</title>
    <%screenStyleSheet%>
    <%printerStyleSheet%>
	<script type="text/javascript">
		var REPORT_ISSUES = "";
		
		function getImgTag(health){
			return "<img src='<%hosturl%>MKS_ALM_2009/" + health.toLowerCase() + ".gif' alt='" + health + "'/>";
		}
		 
		//project 数量
		var Projects =[];
		//project 統計字段
		var projectCountData = {};
		
		var ChangeOrderDateInit = [];
		var ChangeRequestStateDateInit = [];
		var RiskDateInit = [];
		
		var DefectTypeDataInit = [];
		var TaskPhasDataInit = [];
		var DefectStateDateInit = [];
		var DefectResponsibilityTeamDateInit = [];
		var ChangeRequestDateInit = [];
		
	</script>
</head>
<%dateformat MM/dd/yy HH:mm:ss%>
<%datetimeformat MM/dd/yyyy h:mm:ss a%>
<body style="padding:2% 5% 2% 5%; ">
<%begindetail%>
<script>
   
	if("<%<%builtin Type%>%>" == "Change Order"){
		 ChangeOrderDateInit.push({"<%<%builtin Project%>%>":"<%State%>"});
	}
	if("<%<%builtin Type%>%>" == "Change Request"){
		 ChangeRequestStateDateInit.push({"<%<%builtin Project%>%>":"<%State%>"});
		 ChangeRequestDateInit.push({"<%<%builtin Project%>%>":"<%Change Category%>"+":"+"<%Change Initiator%>"});
	}
	if("<%<%builtin Type%>%>" == "Risk"){
		 RiskDateInit.push({"<%<%builtin Project%>%>":"<%State%>"});
	}
    if("<%<%builtin Type%>%>" == "Defect"){
		 DefectTypeDataInit.push({"<%<%builtin Project%>%>":"<%Defect Type%>"+":"+"<%Defect Source%>"});
		 TaskPhasDataInit.push({"<%<%builtin Project%>%>":"<%Origin%>"+":"+"<%Task Phase%>"});
		 DefectStateDateInit.push({"<%<%builtin Project%>%>":"<%State%>"+":"+"<%defectState%>"});
		 DefectResponsibilityTeamDateInit.push({"<%<%builtin Project%>%>":"<%State%>"+":"+"<%Responsibility Team%>"}); 
	}
	
	 
	 if(Projects.indexOf("<%<%builtin Project%>%>") == -1){
		Projects.push("<%<%builtin Project%>%>");
		var project  ={
					"projectType" : "<%<%builtin Type%>%>",
					"projectId" : "<%<%builtin ID%>%>",
					"ProjectSummary" : "<%<%builtin Summary%>%>",
					"ProjectIdA" : "<%hosturl%>im/WebClient?IssueID=<%<%builtin ID%>%>",
					
					"State" : "<%<%builtin State%>%>",
					"ASIL" : "<%ASIL%>",
					"Project Start Date" : "<%Project Start Date%>",
					"Project End Date" : "<%Project End Date%>",
					"Project Manager" : "<%<%builtin Assigned User%>%>",
					"TeamMembers" : "<%TeamMembers%>",
					"Project Start" : "<%Project Start Actual%>",
					"Project Acceptance" : "<%Project Acceptance Actual%>",
					"Project Plan" : "<%Project Plan Actual%>",
					"Functional Specification Freeze" : "<%Functional Specification Freeze Actual%>",
					"Code Freeze" : "<%Code Freeze Actual%>",
					"Development Complete" : "<%Development Complete Actual%>",
					
					"Pending Stakeholder Requirement Document Count":"<%Pending Stakeholder Requirement Document Count%>",
					"Open Stakeholder Requirement Document Count":"<%Open Stakeholder Requirement Document Count%>",
					"Close Stakeholder Requirement Document Count":"<%Close Stakeholder Requirement Document Count%>",
					"Total Stakeholder Requirement Document Count":"<%Total Stakeholder Requirement Document Count%>",
					"Pending System Requirement Specification Document Count":"<%Pending System Requirement Specification Document Count%>",
					"Open System Requirement Specification Document Count":"<%Open System Requirement Specification Document Count%>",
					"Closed System Requirement Specification Document Count":"<%Closed System Requirement Specification Document Count%>",
					"Total System Requirement Specification Document Count":"<%Total System Requirement Specification Document Count%>",
					"Pending System Architectural Design Specification Document Count":"<%Pending System Architectural Design Specification Document Count%>",
					"Open System Architectural Design Specification Document Count":"<%Open System Architectural Design Specification Document Count%>",
					"Closed System Architectural Design Specification Document Count":"<%Closed System Architectural Design Specification Document Count%>",
					"Total System Architectural Design Specification Document Count":"<%Total System Architectural Design Specification Document Count%>",
					"Pending Software Requirement Specification Document Count":"<%Pending Software Requirement Specification Document Count%>",
					"Open Software Requirement Specification Document Count":"<%Open Software Requirement Specification Document Count%>",
					"Closed Software Requirement Specification Document Count":"<%Closed Software Requirement Specification Document Count%>",
					"Total Software Requirement Specification Document Count":"<%Total Software Requirement Specification Document Count%>",
					"Pending Software Architectural Design Specification Document Count":"<%Pending Software Architectural Design Specification Document Count%>",
					"Open Software Architectural Design Specification Document Count":"<%Open Software Architectural Design Specification Document Count%>",
					"Closed Software Architectural Design Specification Document Count":"<%Closed Software Architectural Design Specification Document Count%>",
					"Total Software Architectural Design Specification Document Count":"<%Total Software Architectural Design Specification Document Count%>",
					"Pending Software Detail Design Specification Document Count":"<%Pending Software Detail Design Specification Document Count%>",
					"Open Software Detail Design Specification Document Count":"<%Open Software Detail Design Specification Document Count%>",
					"Closed Software Detail Design Specification Document Count":"<%Closed Software Detail Design Specification Document Count%>",
					"Total Software Detail Design Specification Document Count":"<%Total Software Detail Design Specification Document Count%>",
					"Pending Hardware Requirement Specification Document Count":"<%Pending Hardware Requirement Specification Document Count%>",
					"Open Hardware Requirement Specification Document Count":"<%Open Hardware Requirement Specification Document Count%>",
					"Closed Hardware Requirement Specification Document Count":"<%Closed Hardware Requirement Specification Document Count%>",
					"Total Hardware Requirement Specification Document Count":"<%Total Hardware Requirement Specification Document Count%>",
					"Pending Models Count E":"<%Pending Models Count E%>",
					"Open Models Count E":"<%Open Models Count E%>",
					"Closed Models Count E":"<%Closed Models Count E%>",
					"Total Models Count E":"<%Total Models Count E%>",
					"Pending Test Objective Count":"<%Pending Test Objective Count%>",
					"Open Test Objective Count":"<%Open Test Objective Count%>",
					"Closed Test Objective Count":"<%Closed Test Objective Count%>",
					"Total Test Objective Count":"<%Total Test Objective Count%>",
					"Pending Test Plan Count E":"<%Pending Test Plan Count E%>",
					"Open Test Plan Count E":"<%Open Test Plan Count E%>",
					"Closed Test Plan Count E":"<%Closed Test Plan Count E%>",
					"Total Models Count E":"<%Total Models Count E%>",
					"Pending Test Objective Count":"<%Pending Test Objective Count%>",
					"Open Test Objective Count":"<%Open Test Objective Count%>",
					"Closed Test Objective Count":"<%Closed Test Objective Count%>",
					"Total Test Objective Count":"<%Total Test Objective Count%>",
					"Pending Test Plan Count E":"<%Pending Test Plan Count E%>",
					"Open Test Plan Count E":"<%Open Test Plan Count E%>",
					"Closed Test Plan Count E":"<%Closed Test Plan Count E%>",
					"Total Test Plan Count E":"<%Total Test Plan Count E%>",
					"Pending Test Suite Count":"<%Pending Test Suite Count%>",
					"Open Test Suite Count":"<%Open Test Suite Count%>",
					"Closed Test Suite Count":"<%Closed Test Suite Count%>",
					"Total Test Suite Count":"<%Total Test Suite Count%>",
					"Pending Test Session Count":"<%Pending Test Session Count%>",
					"Open Test Session Count":"<%Open Test Session Count%>",
					"Closed Test Session Count":"<%Closed Test Session Count%>",
					"Total Test Session Count":"<%Total Test Session Count%>",
					"Pending Defect Count":"<%Pending Defect Count%>",
					"Open Defect Count":"<%Open Defect Count%>",
					"Closed Defect Count":"<%Closed Defect Count%>",
					"Total Defect Count":"<%Total Defect Count%>",
					"Pending Tasks Count E":"<%Pending Tasks Count E%>",
					"Open Tasks Count E":"<%Open Tasks Count E%>",
					"Closed Tasks Count E":"<%Closed Tasks Count E%>",
					"Total Tasks Count E":"<%Total Tasks Count E%>",
					"Pending Change Request Count E":"<%Pending Change Request Count E%>",
					"Open Change Request Count E":"<%Open Change Request Count E%>",
					"Closed Change Request Count E":"<%Closed Change Request Count E%>",
					"Total Change Request Count E":"<%Total Change Request Count E%>",
					"Pending Change Order Count E":"<%Pending Change Order Count E%>",
					"Open Change Order Count E":"<%Open Change Order Count E%>",
					"Closed Change Order Count E":"<%Closed Change Order Count E%>",
					"Total Change Order Count E":"<%Total Change Order Count E%>",
					"Pending Releases Count E":"<%Pending Releases Count E%>",
					"Open Releases Count E":"<%Open Releases Count E%>",
					"Closed Releases Count E":"<%Closed Releases Count E%>",
					"Total Releases Count E":"<%Total Releases Count E%>",
					"Pending Non-conformance Issues Count E":"<%Pending Non-conformance Issues Count E%>",
					"Open Non-conformance Issues Count E":"<%Open Non-conformance Issues Count E%>",
					"Closed Non-conformance Issues Count E":"<%Closed Non-conformance Issues Count E%>",
					"Total Non-conformance Issues Count E":"<%Total Non-conformance Issues Count E%>",
					"Pending Supplier Monitor Tasks Count E":"<%Pending Supplier Monitor Tasks Count E%>",
					"Open Supplier Monitor Tasks Count E":"<%Open Supplier Monitor Tasks Count E%>",
					"Closed Supplier Monitor Tasks Count E":"<%Closed Supplier Monitor Tasks Count E%>",
					"Total Supplier Monitor Tasks Count E":"<%Total Supplier Monitor Tasks Count E%>",
					
					"Total Planned Count Project" : "<%Total Planned Count Project%>",
					"Total Run Count Project" : "<%Total Run Count Project%>",
					"Total Pass Count Project" : "<%Total Pass Count Project%>",
					"Total Fail Count Project" : "<%Total Fail Count Project%>",
					"Total Other Count Project" : "<%Total Other Count Project%>",
					"Total Blocked Count Project" : "<%Total Blocked Count Project%>",
					"Total Suspect Results Count Project" : "<%Total Suspect Results Count Project%>",
					"Total Run Percentage Project" : "<%Total Run Percentage Project%>",
					"Total Pass Percentage of Run Project" : "<%Total Pass Percentage of Run Project%>",
					"Total Pass Percentage of Planned Project" : "<%Total Pass Percentage of Planned Project%>",
					
				};
				
		projectCountData["<%<%builtin Project%>%>"] = 	project;	
	}
	
	  
	
</script>
<%enddetail%>
<div id = "projectDom" style = " margin-bottom:10px">
	
</div>

</body>
<script>
	 
	console.log(ChangeOrderDateInit);  
	console.log(ChangeRequestStateDateInit);  
	console.log(RiskDateInit);  
	console.log(DefectTypeDataInit);  
	console.log(TaskPhasDataInit);  
	console.log(DefectStateDateInit);  
	console.log(DefectResponsibilityTeamDateInit);  
	console.log(ChangeRequestDateInit);  
	
	
      
	
		//统计数据
	var CountData = {}; 
	var RiskDate = {
			"Risk":[{"Open":0},{"In Analysis":0},{"Rejected":0},{"Analyzed":0},{"In Monitoring":0},{"Postponed":0},{"Closed":0}]
		};
	var DefectTypeData = {
			"Function" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Logical" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Norms" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Interface" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Performance" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Grammer" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Design Defect" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture ":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
		}		
	var TaskPhasData = {
			"Software Unit Test":[{"Open":0},{"Pending":0},{"Closed":0}],
			"Software Integration Test":[{"Open":0},{"Pending":0},{"Closed":0}],
			"Software Qulification Test":[{"Open":0},{"Pending":0},{"Closed":0}],
			"System Integration Test":[{"Open":0},{"Pending":0},{"Closed":0}],
			"System Qulification Test":[{"Open":0},{"Pending":0},{"Closed":0}]
		};
	var DefectStateDate = {
			"Open":[{"false":0},{"true":0}],
			"In Testing":[{"false":0},{"true":0}],
			"In Progress":[{"false":0},{"true":0}],
			"In Analysis":[{"false":0},{"true":0}],
			"Analyzed":[{"false":0},{"true":0}]
		};
	var DefectResponsibilityTeamDate = {
			"Open":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"In Analysis":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"Analyzed":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"In Progress":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"InTesting":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"Verified":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"Closed":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"Rejected":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"Postponed":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}]
		};
	var ChangeRequestDate = {
			"REQ change":[{"Customer":0},{"Supplier":0},{"Internal":0}],
			"Design change":[{"Customer":0},{"Supplier":0},{"Internal":0}],
			"Plan change":[{"Customer":0},{"Supplier":0},{"Internal":0}]
		};
	var ChangeRequestStateDate = {
			"Change Request" : [{"Open":0},{"In Progress":0},{"Approved":0},{"Fixed":0},{"Closed":0},{"Rejected":0},{"Cancelled":0},{"Postponed":0}]
		};
	var ChangeOrderDate = {
			"Change Order" : [{"Open":0},{"In Development":0},{"Verify":0},{"Closed":0}]
		};
	
	//先给统计数据初始化
	for(var i = 0;i<Projects.length;i++){  
	   CountData[Projects[i]] = {};
	} 
	
	//循环统计每个project的数据
	function countDate(proDate){
		for(var i = 0;i<Projects.length;i++){ 
		//每个project统计先清空
		RiskDate = {
			"Risk":[{"Open":0},{"In Analysis":0},{"Rejected":0},{"Analyzed":0},{"In Monitoring":0},{"Postponed":0},{"Closed":0}]
		};
	    DefectTypeData = {
			"Function" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Logical" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Norms" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Interface" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Performance" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Grammer" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Design Defect" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture ":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
		}		
	    TaskPhasData = {
			"Software Unit Test":[{"Open":0},{"Pending":0},{"Closed":0}],
			"Software Integration Test":[{"Open":0},{"Pending":0},{"Closed":0}],
			"Software Qulification Test":[{"Open":0},{"Pending":0},{"Closed":0}],
			"System Integration Test":[{"Open":0},{"Pending":0},{"Closed":0}],
			"System Qulification Test":[{"Open":0},{"Pending":0},{"Closed":0}]
		};
		DefectStateDate = {
			"Open":[{"false":0},{"true":0}],
			"In Testing":[{"false":0},{"true":0}],
			"In Progress":[{"false":0},{"true":0}],
			"In Analysis":[{"false":0},{"true":0}],
			"Analyzed":[{"false":0},{"true":0}]
		};
		DefectResponsibilityTeamDate = {
			"Open":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"In Analysis":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"Analyzed":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"In Progress":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"InTesting":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"Verified":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"Closed":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"Rejected":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"Postponed":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}]
		};
		ChangeRequestDate = {
			"REQ change":[{"Customer":0},{"Supplier":0},{"Internal":0}],
			"Design change":[{"Customer":0},{"Supplier":0},{"Internal":0}],
			"Plan change":[{"Customer":0},{"Supplier":0},{"Internal":0}]
		};
		ChangeRequestStateDate = {
			"Change Request" : [{"Open":0},{"In Progress":0},{"Approved":0},{"Fixed":0},{"Closed":0},{"Rejected":0},{"Cancelled":0},{"Postponed":0}]
		};
		ChangeOrderDate = {
			"Change Order" : [{"Open":0},{"In Development":0},{"Verify":0},{"Closed":0}]
		};
	
       //参数1 自定义统计数据  2priject类型 3，统计数据名字 4.查询的总数据 
	  	dlsjtj(ChangeOrderDate,Projects[i],"ChangeOrderDate",ChangeOrderDateInit);
	  	dlsjtj(ChangeRequestStateDate,Projects[i],"ChangeRequestStateDate",ChangeRequestStateDateInit);
	  	dlsjtj(RiskDate,Projects[i],"RiskDate",RiskDateInit);
		
	  	slsjtj(DefectTypeData,Projects[i],"DefectTypeData",DefectTypeDataInit);
	  	slsjtj(TaskPhasData,Projects[i],"TaskPhasData",TaskPhasDataInit);
	  	slsjtj(DefectStateDate,Projects[i],"DefectStateDate",DefectStateDateInit);
	  	slsjtj(DefectResponsibilityTeamDate,Projects[i],"DefectResponsibilityTeamDate",DefectResponsibilityTeamDateInit);
	  	slsjtj(ChangeRequestDate,Projects[i],"ChangeRequestDate",ChangeRequestDateInit);
	    
	    
	   } 
	}
    countDate("");
	getProjectDate();//加载DOM
	//多列数据统计
	function slsjtj(zdysj,projectType,proTypeName,cxsj){
		for(key in zdysj){
			var arr = zdysj[key];
			for(var i =0;i<arr.length;i++){
				var obj = arr[i];
				var name = Object.keys(obj)[0];   
				var value = obj[name];
				var allname = key+":"+name;
				var sl = sjtj(allname,projectType,cxsj); 
				var count = parseInt(value); 
				obj[name] = count+sl;
			}
		}
		CountData[projectType][proTypeName] =  zdysj;
	}
 
	//单列数据统计
    function dlsjtj(zdysj,projectType,proTypeName,cxsj){
		var arr = zdysj[Object.keys(zdysj)[0]];
		for(var i=0;i<arr.length;i++){
			var obj = arr[i];
			var name = Object.keys(obj)[0];  
			var value = obj[name];
			var sl = sjtj(name,projectType,cxsj)
			var count = parseInt(value); 
			obj[name] = count+sl;
		}
		CountData[projectType][proTypeName] =  zdysj ;
	}	
	 console.log("----");
	 
	 //根据查询数据计算数量
	function sjtj(key,projectType,cxsj){
		var count =0;
		for(var i =0;i<cxsj.length;i++){
			var obj = cxsj[i];
			var name = Object.keys(obj)[0];  
			var value = obj[name];
			 
			if(key == value && projectType == name){
				count++;	
			}	
		}
		return count;
	} 
	
    console.log(CountData);
	
 
	//给html赋值
	function getDate(elm,date){
		//console.log(elm);
		//console.log(date);
		var html = '';
		for(var key in date){
			var html1 = '<tr class="odd_row" style="width: 100%;"><th style="text-align:right; width: 30%">'+key+ ':</th>';
			var html2 = "";
			var arr = date[key];
			for(var i =0;i<arr.length;i++){
				var obj = arr[i];
				//console.log(Object.keys(obj)[0]);
				//onsole.log(Object.values(obj)[0]);
			
				html2 += '<td style="text-align:center; "> '+Object.values(obj)[0]+'</td>';
			}			
			html += html1+html2+'</tr>';
		}
		elm.innerHTML = html;
	}
	
	function getDefectStateDate(elm,date){
		var html = '';
		for(var key in date){
			var name = "";
			if(key == "Open"){
				name = "Problem Definition";
			}else if(key == "In Testing"){
				name = "Validation and Closed";
			}else if(key == "In Progress"){
				name = "Execute Corrective Action";
			}else if(key == "In Analysis"){
				name = "Problem Confirmation";
			}else if(key == "Analyzed"){
				name = "Develop Inverstigation";
			}
			var html1 = '<tr class="odd_row" style="width: 100%;"><th style="text-align:right; width: 30%">'+name+ ':</th>';
			var html2 = "";
			var arr = date[key];
			for(var i =0;i<arr.length;i++){
				var obj = arr[i];
				//console.log(Object.keys(obj)[0]);
				//onsole.log(Object.values(obj)[0]);
			
				html2 += '<td style="text-align:center; "> '+Object.values(obj)[0]+'</td>';
			}			
			html += html1+html2+'</tr>';
		}
		elm.innerHTML = html;
	}
	
	
	function getProjectDate(){
		var html = '';
		//先加载所有dom
		for(var key in CountData){
			var projectData = projectCountData[key]; //project统计数据
			var obj = CountData[key];
			
			//console.log("sj---------:"+obj["ProjectIdA"]);
			html += '<p class="title">'+projectData["projectType"]+' <a class="title" href="'+projectData["ProjectIdA"]+'" target="_blank">'+projectData["projectId"]+'</a>: '+projectData["ProjectSummary"]+'</p>\n' +
        '<table class="detailrows fullWidth">\n' +
        '\t<tr>\n' +
        '\t\t<td style="width: 50%;">\n' +
        '\t\t\t<table class="detailrows" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th nowrap style="width: 30%;">State:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+projectData["State"]+'</td>\n' +
        '\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th nowrap style="width: 30%;">ASIL:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+projectData["ASIL"]+'</td>\n' +
        '\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th nowrap style="width: 30%;">Project Start Date:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+projectData["Project Start Date"]+'</td>\n' +
        '\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th nowrap style="width: 30%;">Project End Date:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+projectData["Project End Date"]+'</td>\n' +
        '\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th nowrap style="width: 30%;">Project Manager:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+projectData["Project Manager"]+'</td>\n' +
        '\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th nowrap style="width: 15%;">TeamMembers:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+projectData["TeamMembers"]+'</td>\n' +
        '\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t</table>\n' +
        '\t\t\t\n' +
        '\t\t</td>\n' +
        '\t\t<td style="vertical-align: top; width: 50%;">\n' +
        '\t\t\t<table class="detailrows" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th nowrap style="text-align:right; width: 30%;">Project Start:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+projectData["Project Start"]+'</td>\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t\t<th nowrap style="text-align:right; width: 30%;">Project Acceptance:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+projectData["Project Acceptance"]+'</td>\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t\t<th nowrap style="text-align:right; width: 30%;">Project Plan:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+projectData["Project Plan"]+'</td>\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t\t<th nowrap style="text-align:right; width: 30%;">Functional Specification Freeze:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+projectData["Functional Specification Freeze"]+'</td>\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t\t<th nowrap style="text-align:right; width: 30%;">Code Freeze:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+projectData["Code Freeze"]+'</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t\t<th nowrap style="text-align:right; width: 30%; ">Development Complete:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%; ">'+projectData["Development Complete"]+'</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '\t<tr><td>&nbsp;</td></tr>\n' +
        '\t<tr><td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center"><b>Process Metrics</b></td></tr>\n' +
        '\t<tr>\n' +
        '\t\t<td style="width: 100%;" colspan="2">\n' +
        '\t\t\t<table class="detailcols" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row" style="width: 100%;">\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 40%" ></th>\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 15%" >Pending</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 15%" >Open</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 15%" >Closed</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 15%" >Total</th>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row" style="width: 100%;">\n' +
        '\t\t\t\t\t<th style="text-align:right; width: 40%">Stakeholder Requirement Documents:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center; width: 15%" >'+projectData["Pending Stakeholder Requirement Document Count"]+'</td>\n' +
        '\t\t\t\t\t<td style="text-align:center; width: 15%">'+projectData["Open Stakeholder Requirement Document Count"]+'</td>\n' +
        '\t\t\t\t\t<td style="text-align:center; width: 15%">'+projectData["Close Stakeholder Requirement Document Count"]+'</td>\n' +
        '\t\t\t\t\t<td style="text-align:center; width: 15%">\n' +
        '\t\t\t\t\t\t'+projectData["Total Stakeholder Requirement Document Count"]+'\n' +
        '\t\t\t\t\t</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">System Requirement Specification Documents:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Pending System Requirement Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Open System Requirement Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Closed System Requirement Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">\n' +
        '\t\t\t\t\t\t'+projectData["Total System Requirement Specification Document Count"]+' \n' +
        '\t\t\t\t\t</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">System Architectural Design Specification Documents:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Pending System Architectural Design Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Open System Architectural Design Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Closed System Architectural Design Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">\n' +
        '\t\t\t\t\t\t'+projectData["Total System Architectural Design Specification Document Count"]+' \n' +
        '\t\t\t\t\t</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Software Requirement Specification Documents:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Pending Software Requirement Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Open Software Requirement Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Closed Software Requirement Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">\n' +
        '\t\t\t\t\t\t'+projectData["Total Software Requirement Specification Document Count"]+' \n' +
        '\t\t\t\t\t</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Software Architectural Design Specification Documents:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Pending Software Architectural Design Specification Document Count"]+'</td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Open Software Architectural Design Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Closed Software Architectural Design Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">\n' +
        '\t\t\t\t\t\t'+projectData["Total Software Architectural Design Specification Document Count"]+' \n' +
        '\t\t\t\t\t</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Software Detail Design Specification Documents:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Pending Software Detail Design Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Open Software Detail Design Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Closed Software Detail Design Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">\n' +
        '\t\t\t\t\t\t'+projectData["Total Software Detail Design Specification Document Count"]+' \n' +
        '\t\t\t\t\t</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Hardware Requirement Specification Documents:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Pending Hardware Requirement Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Open Hardware Requirement Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Closed Hardware Requirement Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Total Hardware Requirement Specification Document Count"]+' \n' +
        '\t\t\t\t\t</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Models:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Pending Models Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Open Models Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Closed Models Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Total Models Count E"]+' </td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Test Objectives:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Pending Test Objective Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Open Test Objective Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Closed Test Objective Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Total Test Objective Count"]+'</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Test Plans:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Pending Test Plan Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Open Test Plan Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Closed Test Plan Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Total Test Plan Count E"]+' </td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Test Suites:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Pending Test Suite Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Open Test Suite Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Closed Test Suite Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Total Test Suite Count"]+' \n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t\t</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Test Sessions:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Pending Test Session Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Open Test Session Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Closed Test Session Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Total Test Session Count"]+' \n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t\t</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Defects:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Pending Defect Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Open Defect Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Closed Defect Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Total Defect Count"]+' </td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Tasks:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Pending Tasks Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Open Tasks Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Closed Tasks Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Total Tasks Count E"]+' </td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Change Requests:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Pending Change Request Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Open Change Request Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Closed Change Request Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Total Change Request Count E"]+' </td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Change Orders:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Pending Change Order Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Open Change Order Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Closed Change Order Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Total Change Order Count E"]+'</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Releases:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Pending Releases Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Open Releases Count E"]+'</td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Closed Releases Count E"]+'</td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Total Releases Count E"]+' </td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Non-conformance Issues:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Pending Non-conformance Issues Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Open Non-conformance Issues Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Closed Non-conformance Issues Count E"]+'</td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Total Non-conformance Issues Count E"]+' </td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Supplier Monitor Tasks:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Pending Supplier Monitor Tasks Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Open Supplier Monitor Tasks Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Closed Supplier Monitor Tasks Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+projectData["Total Supplier Monitor Tasks Count E"]+' </td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '\t<tr><td>&nbsp;</td></tr>\n' +
        '\t<tr><td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center"><b>Quality Metrics</b></td></tr>\n' +
        '\t<tr>\n' +
        '\t\t<td>\n' +
        '\t\t\t<table class="detailrows">\n' +
        '\t\t\t\t<tr class="even_row"><th nowrap>Total Planned Count:</th><td width="100%">'+projectData["Total Planned Count Project"]+'</td></tr>\n' +
        '\t\t\t\t<tr class="odd_row"><th nowrap>Total Run Count:</th><td width="100%">'+projectData["Total Run Count Project"]+' </td></tr>\n' +
        '\t\t\t\t<tr class="even_row"><th nowrap>Total Pass Count:</th><td width="100%">'+projectData["Total Pass Count Project"]+' </td></tr>\n' +
        '\t\t\t\t<tr class="odd_row"><th nowrap>Total Fail Count:</th><td width="100%">'+projectData["Total Fail Count Project"]+' </td></tr>\n' +
        '\t\t\t\t<tr class="even_row"><th nowrap>Total Other Count:</th><td width="100%">'+projectData["Total Other Count Project"]+' </td></tr>\n' +
        '\t\t\t\t<tr class="odd_row"><th nowrap>Total Blocked Count:</th><td width="100%">'+projectData["Total Blocked Count Project"]+' </td></tr>\n' +
        '\t\t\t\t<tr class="even_row"><th nowrap>Total Suspect Results Count:</th><td width="100%">'+projectData["Total Suspect Results Count Project"]+' </td></tr>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t\t<td valign="top">\n' +
        '\t\t\t<table class="detailrows">\n' +
        '\t\t\t<tr><th nowrap>Total Run Percentage:</th><td>'+projectData["Total Run Percentage Project"]+' </td></tr>\n' +
        '\t\t\t<tr><th nowrap>Total Pass Percentage of Run:</th><td>'+projectData["Total Pass Percentage of Run Project"]+' </tr>\n' +
        '\t\t\t<tr><th nowrap>Total Pass Percentage of Planned:</th><td>'+projectData["Total Pass Percentage of Planned Project"]+'</td></tr>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '</table>'+
		
		'<table class="detailrows fullWidth">\n' +
        '<!-- Risk start -->\n' +
       
        '\t<tr>\n' +
        '\t\t<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">\n' +
        '\t\t\t<b>Risk Metrics</b>\n' +
        '\t\t</td> \n' +
        '\t</tr>\n' +
        '\t<tr>\n' +
        '\t\t<td style="width: 100%;" colspan="2">\n' +
        '\t\t\t<table class="detailcols" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row" style="width: 100%;">\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 30%" ></th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Open</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >In Analysis</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Rejected</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Analyzed</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >In Monitoring</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Postponed</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Closed</th>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tbody id = "RiskState'+projectData["projectId"]+'">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tbody>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '<!-- Risk end -->\n' +
        '\t\n' +
        '<!-- Defect start -->\n' +
        '\t<tr><td>&nbsp;</td></tr>\n' +
       
        '\t<tr>\n' +
        '\t\t<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">\n' +
        '\t\t\t<b>Defect Metrics</b>\n' +
        '\t\t</td> \n' +
        '\t</tr>\n' +
        '\t<tr>\n' +
        '\t\t<td style="width: 100%;" colspan="2">\n' +
        '\t\t\t<table class="detailcols" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row" style="width: 100%;">\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 30%" ></th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Requirement</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >System Architecture</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Software Architecture</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Software Detailed Design</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Code</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Test</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Software Integration</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >System Integration</th>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tbody id = "defectTypeAndSousce'+projectData["projectId"]+'">\n' +
        '\t\t\t\t\t \n' +
        '\t\t\t\t</tbody>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '<!-- Defect end -->\n' +
        '\t\n' +
        '<!-- Defect Origin and Task Phase start -->\n' +
        '\t<tr><td>&nbsp;</td></tr>\n' +
        '\t<tr>\n' +
        '\t\t<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">\n' +
        '\t\t\t<b>Defect Origin and Task Phase</b>\n' +
        '\t\t</td> \n' +
        '\t</tr>\n' +
        '\t<tr>\n' +
        '\t\t<td style="width: 100%;" colspan="2">\n' +
        '\t\t\t<table class="detailcols" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row" style="width: 100%;">\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 30%" ></th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Open</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Pending</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Closed</th>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tbody id = "defectOriginAndTaskPhase'+projectData["projectId"]+'">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tbody>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '<!-- Defect Origin and Task Phase end -->\n' +
        '\n' +
        '<!-- Defect State and defectState start -->\n' +
        '\t<tr><td>&nbsp;</td></tr>\n' +
        '\t<tr>\n' +
        '\t\t<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">\n' +
        '\t\t\t<b>Defect State and defectState</b>\n' +
        '\t\t</td> \n' +
        '\t</tr>\n' +
        '\t<tr>\n' +
        '\t\t<td style="width: 100%;" colspan="2">\n' +
        '\t\t\t<table class="detailcols" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row" style="width: 100%;">\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 30%" ></th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Not Delay</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Delay</th>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tbody id = "defectStateAndDefectState'+projectData["projectId"]+'">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tbody>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '<!-- Defect State and defectState end -->\n' +
        '\n' +
        '<!-- Defect State and Responsibility Team start -->\n' +
        '\t<tr><td>&nbsp;</td></tr>\n' +
        '\t<tr>\n' +
        '\t\t<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">\n' +
        '\t\t\t<b>Defect State and Responsibility Team</b>\n' +
        '\t\t</td> \n' +
        '\t</tr>\n' +
        '\t<tr>\n' +
        '\t\t<td style="width: 100%;" colspan="2">\n' +
        '\t\t\t<table class="detailcols" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row" style="width: 100%;">\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 30%" ></th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >PM</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >STS</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >ASW</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >BSW</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >HW</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >TEST</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >QA</th>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tbody id = "defectStateAndResponsibilityTeam'+projectData["projectId"]+'">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tbody>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '<!-- Defect State and Responsibility Team end -->\n' +
        '\n' +
        '\t\n' +
        '<!-- Change Request Change Category and Change Initiator start -->\n' +
        '\t<tr><td>&nbsp;</td></tr>\n' +
       
        '\t<tr>\n' +
        '\t\t<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">\n' +
        '\t\t\t<b>Change Category and Change Initiator</b>\n' +
        '\t\t</td> \n' +
        '\t</tr>\n' +
        '\t<tr>\n' +
        '\t\t<td style="width: 100%;" colspan="2">\n' +
        '\t\t\t<table class="detailcols" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row" style="width: 100%;">\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 30%" ></th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Customer</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Supplier</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Internal</th>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tbody id = "ChangeCategoryAndChangeInitiator'+projectData["projectId"]+'">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tbody>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '<!-- Change Request Change Category and Change Initiator end -->\n' +
        '\n' +
        '<!-- Change Request State start -->\n' +
        '\t<tr><td>&nbsp;</td></tr>\n' +
        '\t<tr>\n' +
        '\t\t<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">\n' +
        '\t\t\t<b>Change Request State</b>\n' +
        '\t\t</td> \n' +
        '\t</tr>\n' +
        '\t<tr>\n' +
        '\t\t<td style="width: 100%;" colspan="2">\n' +
        '\t\t\t<table class="detailcols" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row" style="width: 100%;">\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 30%" ></th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Open</th>\n' + 
        '\t\t\t\t\t<th style="text-align:center; " >In Progress</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Approved</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Fixed</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Closed</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Rejected</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Cancelled</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Postponed</th>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tbody id = "ChangeRequestState'+projectData["projectId"]+'">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tbody>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '<!-- Change Request State end -->\n' +
        '\n' +
        '<!-- Change Order State start -->\n' +
        '\t<tr><td>&nbsp;</td></tr>\n' +
       
        '\t<tr>\n' +
        '\t\t<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">\n' +
        '\t\t\t<b>ChangeOrder State</b>\n' +
        '\t\t</td> \n' +
        '\t</tr>\n' +
        '\t<tr>\n' +
        '\t\t<td style="width: 100%;" colspan="2">\n' +
        '\t\t\t<table class="detailcols" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row" style="width: 100%;">\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 30%" ></th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Open</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >In Development</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Verify</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Closed</th>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tbody id = "ChangeOrderState'+projectData["projectId"]+'">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tbody>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '<!-- Change Order State end -->\n' +
        '\t\n' +
        '</table>'
		
		}

		document.getElementById("projectDom").innerHTML = html;
		
		//在给需要赋值的dom赋值
		for(var key in CountData){
			var arr = CountData[key];
			var project1 = projectCountData[key]; //project统计数据
		 
			
			getDate(document.getElementById("RiskState"+project1["projectId"]),arr["RiskDate"]);
			
			getDate(document.getElementById("defectTypeAndSousce"+project1["projectId"]),arr["DefectTypeData"]);
			getDate(document.getElementById("defectOriginAndTaskPhase"+project1["projectId"]),arr["TaskPhasData"]);
			getDefectStateDate(document.getElementById("defectStateAndDefectState"+project1["projectId"]),arr["DefectStateDate"]);
			getDate(document.getElementById("defectStateAndResponsibilityTeam"+project1["projectId"]),arr["DefectResponsibilityTeamDate"]);
			
			getDate(document.getElementById("ChangeCategoryAndChangeInitiator"+project1["projectId"]),arr["ChangeRequestDate"]);
			getDate(document.getElementById("ChangeRequestState"+project1["projectId"]),arr["ChangeRequestStateDate"]);
			
			getDate(document.getElementById("ChangeOrderState"+project1["projectId"]),arr["ChangeOrderDate"]);
		}
		 
		
	}
</script>
</html>
