<%version 1%>
<%description
    <b>Data: </b>Project Status<br>
    <b>Notes: </b>This report displays project status.<br>
%>
<%param 
    name="reporttitle" 
    type="String" 
    prompt="Report Title" 
    value="Inline Project Status" 
    description="Descriptive title for your report."
%>
<%param
    name="reportheader" 
    type="MultiString" 
    prompt="Report Header" 
    value="" 
    description="Text appearing at the top of the report page."
%>
<%param
    name="reportfooter" 
    type="MultiString" 
    prompt="Report Footer" 
    value="" 
    description="Text appearing at the bottom of the report page."
%>

<html>
<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>&reporttitle</title>
    <%screenStyleSheet%>
    <%printerStyleSheet%>
	<script type="text/javascript">
		var REPORT_ISSUES = "";
		
		function getImgTag(health){
			return "<img src='<%hosturl%>MKS_ALM_2009/" + health.toLowerCase() + ".gif' alt='" + health + "'/>";
		}
		
			
		var ProjectDate = [];
		 
		var Projects =[];
		
		//var RiskDate = [{"Open":0},{"In Analysis":0},{"Rejected":0},{"Analyzed":0},{"In Monitoring":0},{"Postponed":0},{"Cloesd":0}];
		var RiskDate = {
			"Risk":[{"Open":0},{"In Analysis":0},{"Rejected":0},{"Analyzed":0},{"In Monitoring":0},{"Postponed":0},{"Cloesd":0}]
		};
		
		var DefectTypeData = {
			"Function" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Logical" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Norms" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Interface" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Performance" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Grammer" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Design Defect" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture ":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
		}		
		var TaskPhasData = {
			"Software Unit Test":[{"Open":0},{"Pending":0},{"Closed":0}],
			"Software Integration Test":[{"Open":0},{"Pending":0},{"Closed":0}],
			"Software Qulification Test":[{"Open":0},{"Pending":0},{"Closed":0}],
			"System Integration Test":[{"Open":0},{"Pending":0},{"Closed":0}],
			"System Qulification Test":[{"Open":0},{"Pending":0},{"Closed":0}]
		};
		var DefectStateDate = {
			"Open":[{"false":0},{"true":0}],
			"In Testing":[{"false":0},{"true":0}],
			"In Progress":[{"false":0},{"true":0}],
			"In Analysis":[{"false":0},{"true":0}],
			"Analyzed":[{"false":0},{"true":0}]
		};
		var DefectResponsibilityTeamDate = {
			"Open":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"In Analysis":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"Analyzed":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"In Progress":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"InTesting":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"Verified":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"Closed":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"Rejected":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"Postponed":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}]
		};
		var ChangeRequestDate = {
			"REQ Change":[{"Customer":0},{"Supplier":0},{"Internal":0}],
			"Design Change":[{"Customer":0},{"Supplier":0},{"Internal":0}],
			"Plan Change":[{"Customer":0},{"Supplier":0},{"Internal":0}]
		};
		var ChangeRequestStateDate = {
			"ChangeRequest" : [{"Open":0},{"In Progress":0},{"Approveed":0},{"Fixed":0},{"Closed":0},{"Rejected":0},{"Cancelled":0},{"Postponed":0}]
		};
		var ChangeOrderDate = {
			"ChangeOrder" : [{"Open":0},{"In Development":0},{"Verify":0},{"Closed":0}]
		};
	</script>
</head>
<%dateformat MM/dd/yy HH:mm:ss%>
<%datetimeformat MM/dd/yyyy h:mm:ss a%>
<body style="padding:2% 5% 2% 5%; ">
<%begindetail%>
<script>
	//Project数据 
	var data = {
		"project" : {},
		"RiskDate" : {},
		"DefectTypeData" : {},
		"TaskPhasData" : {},
		"DefectStateDate" : {},
		"DefectResponsibilityTeamDate" : {},
		"ChangeRequestStateDate" : {},
		"ChangeRequestDate" : {},
		"ChangeOrderDate" : {},
	};
	console.log("Type : "+"<%<%builtin Type%>%>");
	console.log("project : "+"<%<%builtin Project%>%>");
	if(Projects.indexOf("<%<%builtin Project%>%>") == -1){
		//每个project都要清除全局统计数据
		DefectTypeData = {
			"Function" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Logical" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Norms" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Interface" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Performance" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Grammer" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
			"Design Defect" :[{"Requirement":0},{"System Architecture":0},{"Software Architecture ":0},{"Software Detailed Design":0},{"Code":0},{"Test":0},
			{"Software Integration":0},{"System Integration":0}],
		}		
		TaskPhasData = {
			"Software Unit Test":[{"Open":0},{"Pending":0},{"Closed":0}],
			"Software Integration Test":[{"Open":0},{"Pending":0},{"Closed":0}],
			"Software Qulification Test":[{"Open":0},{"Pending":0},{"Closed":0}],
			"System Integration Test":[{"Open":0},{"Pending":0},{"Closed":0}],
			"System Qulification Test":[{"Open":0},{"Pending":0},{"Closed":0}]
		};
		DefectStateDate = {
			"Open":[{"false":0},{"true":0}],
			"In Testing":[{"false":0},{"true":0}],
			"In Progress":[{"false":0},{"true":0}],
			"In Analysis":[{"false":0},{"true":0}],
			"Analyzed":[{"false":0},{"true":0}]
		};
		DefectResponsibilityTeamDate = {
			"Open":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"In Analysis":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"Analyzed":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"In Progress":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"InTesting":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"Verified":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"Closed":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"Rejected":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
			"Postponed":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}]
		};
		ChangeRequestDate = {
			"REQ Change":[{"Customer":0},{"Supplier":0},{"Internal":0}],
			"Design Change":[{"Customer":0},{"Supplier":0},{"Internal":0}],
			"Plan Change":[{"Customer":0},{"Supplier":0},{"Internal":0}]
		};
		ChangeRequestStateDate = {
			"ChangeRequest" : [{"Open":0},{"In Progress":0},{"Approveed":0},{"Fixed":0},{"Closed":0},{"Rejected":0},{"Cancelled":0},{"Postponed":0}]
		};
		ChangeOrderDate = {
			"ChangeOrder" : [{"Open":0},{"In Development":0},{"Verify":0},{"Closed":0}]
		};
		Projects.push("<%<%builtin Project%>%>");
		
		console.log(111111);
	}
	
	if("<%<%builtin Type%>%>" == "Project" && Projects[Projects.length-1] == "<%<%builtin Project%>%>"){
		
		var project  ={
					"projectType" : "<%<%builtin Type%>%>",
					"projectId" : "<%<%builtin ID%>%>",
					"ProjectSummary" : "<%<%builtin Summary%>%>",
					"ProjectIdA" : "<%hosturl%>im/WebClient?IssueID=<%<%builtin ID%>%>",
					
					"State" : "<%<%builtin State%>%>",
					"ASIL" : "<%ASIL%>",
					"Project Start Date" : "<%Project Start Date%>",
					"Project End Date" : "<%Project End Date%>",
					"Project Manager" : "<%<%builtin Assigned User%>%>",
					"TeamMembers" : "<%TeamMembers%>",
					"Project Start" : "<%Project Start Actual%>",
					"Project Acceptance" : "<%Project Acceptance Actual%>",
					"Project Plan" : "<%Project Plan Actual%>",
					"Functional Specification Freeze" : "<%Functional Specification Freeze Actual%>",
					"Code Freeze" : "<%Code Freeze Actual%>",
					"Development Complete" : "<%Development Complete Actual%>",
					
					"Pending Stakeholder Requirement Document Count":"<%Pending Stakeholder Requirement Document Count%>",
					"Open Stakeholder Requirement Document Count":"<%Open Stakeholder Requirement Document Count%>",
					"Close Stakeholder Requirement Document Count":"<%Close Stakeholder Requirement Document Count%>",
					"Total Stakeholder Requirement Document Count":"<%Total Stakeholder Requirement Document Count%>",
					"Pending System Requirement Specification Document Count":"<%Pending System Requirement Specification Document Count%>",
					"Open System Requirement Specification Document Count":"<%Open System Requirement Specification Document Count%>",
					"Closed System Requirement Specification Document Count":"<%Closed System Requirement Specification Document Count%>",
					"Total System Requirement Specification Document Count":"<%Total System Requirement Specification Document Count%>",
					"Pending System Architectural Design Specification Document Count":"<%Pending System Architectural Design Specification Document Count%>",
					"Open System Architectural Design Specification Document Count":"<%Open System Architectural Design Specification Document Count%>",
					"Closed System Architectural Design Specification Document Count":"<%Closed System Architectural Design Specification Document Count%>",
					"Total System Architectural Design Specification Document Count":"<%Total System Architectural Design Specification Document Count%>",
					"Pending Software Requirement Specification Document Count":"<%Pending Software Requirement Specification Document Count%>",
					"Open Software Requirement Specification Document Count":"<%Open Software Requirement Specification Document Count%>",
					"Closed Software Requirement Specification Document Count":"<%Closed Software Requirement Specification Document Count%>",
					"Total Software Requirement Specification Document Count":"<%Total Software Requirement Specification Document Count%>",
					"Pending Software Architectural Design Specification Document Count":"<%Pending Software Architectural Design Specification Document Count%>",
					"Open Software Architectural Design Specification Document Count":"<%Open Software Architectural Design Specification Document Count%>",
					"Closed Software Architectural Design Specification Document Count":"<%Closed Software Architectural Design Specification Document Count%>",
					"Total Software Architectural Design Specification Document Count":"<%Total Software Architectural Design Specification Document Count%>",
					"Pending Software Detail Design Specification Document Count":"<%Pending Software Detail Design Specification Document Count%>",
					"Open Software Detail Design Specification Document Count":"<%Open Software Detail Design Specification Document Count%>",
					"Closed Software Detail Design Specification Document Count":"<%Closed Software Detail Design Specification Document Count%>",
					"Total Software Detail Design Specification Document Count":"<%Total Software Detail Design Specification Document Count%>",
					"Pending Hardware Requirement Specification Document Count":"<%Pending Hardware Requirement Specification Document Count%>",
					"Open Hardware Requirement Specification Document Count":"<%Open Hardware Requirement Specification Document Count%>",
					"Closed Hardware Requirement Specification Document Count":"<%Closed Hardware Requirement Specification Document Count%>",
					"Total Hardware Requirement Specification Document Count":"<%Total Hardware Requirement Specification Document Count%>",
					"Pending Models Count E":"<%Pending Models Count E%>",
					"Open Models Count E":"<%Open Models Count E%>",
					"Closed Models Count E":"<%Closed Models Count E%>",
					"Total Models Count E":"<%Total Models Count E%>",
					"Pending Test Objective Count":"<%Pending Test Objective Count%>",
					"Open Test Objective Count":"<%Open Test Objective Count%>",
					"Closed Test Objective Count":"<%Closed Test Objective Count%>",
					"Total Test Objective Count":"<%Total Test Objective Count%>",
					"Pending Test Plan Count E":"<%Pending Test Plan Count E%>",
					"Open Test Plan Count E":"<%Open Test Plan Count E%>",
					"Closed Test Plan Count E":"<%Closed Test Plan Count E%>",
					"Total Models Count E":"<%Total Models Count E%>",
					"Pending Test Objective Count":"<%Pending Test Objective Count%>",
					"Open Test Objective Count":"<%Open Test Objective Count%>",
					"Closed Test Objective Count":"<%Closed Test Objective Count%>",
					"Total Test Objective Count":"<%Total Test Objective Count%>",
					"Pending Test Plan Count E":"<%Pending Test Plan Count E%>",
					"Open Test Plan Count E":"<%Open Test Plan Count E%>",
					"Closed Test Plan Count E":"<%Closed Test Plan Count E%>",
					"Total Test Plan Count E":"<%Total Test Plan Count E%>",
					"Pending Test Suite Count":"<%Pending Test Suite Count%>",
					"Open Test Suite Count":"<%Open Test Suite Count%>",
					"Closed Test Suite Count":"<%Closed Test Suite Count%>",
					"Total Test Suite Count":"<%Total Test Suite Count%>",
					"Pending Test Session Count":"<%Pending Test Session Count%>",
					"Open Test Session Count":"<%Open Test Session Count%>",
					"Closed Test Session Count":"<%Closed Test Session Count%>",
					"Total Test Session Count":"<%Total Test Session Count%>",
					"Pending Defect Count":"<%Pending Defect Count%>",
					"Open Defect Count":"<%Open Defect Count%>",
					"Closed Defect Count":"<%Closed Defect Count%>",
					"Total Defect Count":"<%Total Defect Count%>",
					"Pending Tasks Count E":"<%Pending Tasks Count E%>",
					"Open Tasks Count E":"<%Open Tasks Count E%>",
					"Closed Tasks Count E":"<%Closed Tasks Count E%>",
					"Total Tasks Count E":"<%Total Tasks Count E%>",
					"Pending Change Request Count E":"<%Pending Change Request Count E%>",
					"Open Change Request Count E":"<%Open Change Request Count E%>",
					"Closed Change Request Count E":"<%Closed Change Request Count E%>",
					"Total Change Request Count E":"<%Total Change Request Count E%>",
					"Pending Change Order Count E":"<%Pending Change Order Count E%>",
					"Open Change Order Count E":"<%Open Change Order Count E%>",
					"Closed Change Order Count E":"<%Closed Change Order Count E%>",
					"Total Change Order Count E":"<%Total Change Order Count E%>",
					"Pending Releases Count E":"<%Pending Releases Count E%>",
					"Open Releases Count E":"<%Open Releases Count E%>",
					"Closed Releases Count E":"<%Closed Releases Count E%>",
					"Total Releases Count E":"<%Total Releases Count E%>",
					"Pending Non-conformance Issues Count E":"<%Pending Non-conformance Issues Count E%>",
					"Open Non-conformance Issues Count E":"<%Open Non-conformance Issues Count E%>",
					"Closed Non-conformance Issues Count E":"<%Closed Non-conformance Issues Count E%>",
					"Total Non-conformance Issues Count E":"<%Total Non-conformance Issues Count E%>",
					"Pending Supplier Monitor Tasks Count E":"<%Pending Supplier Monitor Tasks Count E%>",
					"Open Supplier Monitor Tasks Count E":"<%Open Supplier Monitor Tasks Count E%>",
					"Closed Supplier Monitor Tasks Count E":"<%Closed Supplier Monitor Tasks Count E%>",
					"Total Supplier Monitor Tasks Count E":"<%Total Supplier Monitor Tasks Count E%>",
					
					"Total Planned Count Project" : "<%Total Planned Count Project%>",
					"Total Run Count Project" : "<%Total Run Count Project%>",
					"Total Pass Count Project" : "<%Total Pass Count Project%>",
					"Total Fail Count Project" : "<%Total Fail Count Project%>",
					"Total Other Count Project" : "<%Total Other Count Project%>",
					"Total Blocked Count Project" : "<%Total Blocked Count Project%>",
					"Total Suspect Results Count Project" : "<%Total Suspect Results Count Project%>",
					"Total Run Percentage Project" : "<%Total Run Percentage Project%>",
					"Total Pass Percentage of Run Project" : "<%Total Pass Percentage of Run Project%>",
					"Total Pass Percentage of Planned Project" : "<%Total Pass Percentage of Planned Project%>",
					
				};
		

		data.project = project;
		ProjectDate[Projects.length-1] = data;	
	}
	
	//risk数据
	if("<%<%builtin Type%>%>" == "Risk"  && Projects[Projects.length-1] == "<%<%builtin Project%>%>"){
		//risk State
		for(var key in RiskDate){ 
			var arr = RiskDate[key];
			for(var i = 0;i<arr.length;i++){
				var obj = arr[i];
				if("<%State%>" == Object.keys(obj)[0]){
					var count = parseInt(obj["<%State%>"]);
					//console.log(count);
					obj["<%State%>"] = count+1;
						
				}
				//console.log(obj);
			}
		}
	}
	//Defect数据
	if("<%<%builtin Type%>%>" == "Defect"  && Projects[Projects.length-1] == "<%<%builtin Project%>%>"){
		//type 和 Source
		for(var key in DefectTypeData){ 
			if("<%Defect Type%>" == key){
				var arr = DefectTypeData[key];
				for(var i = 0;i<arr.length;i++){
					var obj = arr[i];
					//console.log("<%Defect Type%>" +":" + "<%Defect Source%>");
					if("<%Defect Source%>" == Object.keys(obj)[0]){
						var count = parseInt(obj["<%Defect Source%>"]);
						//console.log(count);
						obj["<%Defect Source%>"] = count+1;
						
					}
					//console.log(obj);
				}
			}
		}
		//Origin and Task Phase
		for(var key in TaskPhasData ){ 
			if("<%Origin%>" == key){
				var arr = TaskPhasData[key];
				for(var i = 0;i<arr.length;i++){
					var obj = arr[i];
					//console.log("<%Origin%>" +":" + "<%Task Phase%>");
					if("<%Task Phase%>" == Object.keys(obj)[0]){
						var count = parseInt(obj["<%Task Phase%>"]);
						//console.log(count);
						obj["<%Task Phase%>"] = count+1;
						
					}
					//console.log(obj);
				}
			}
		}
		//State and defectState
		for(var key in DefectStateDate){ 
			if("<%State%>" == key){
				var arr = DefectStateDate[key];
				for(var i = 0;i<arr.length;i++){
					var obj = arr[i];
					//console.log("<%State%>" +":" + "<%defectState%>");
					if("<%defectState%>" == Object.keys(obj)[0]){
						var count = parseInt(obj["<%defectState%>"]);
						//console.log(count);
						obj["<%defectState%>"] = count+1;
						
					}
					//console.log(obj);
				}
			}
		}
		//State and Responsibility Team
		for(var key in DefectResponsibilityTeamDate){ 
			if("<%State%>" == key){
				var arr = DefectResponsibilityTeamDate[key];
				for(var i = 0;i<arr.length;i++){
					var obj = arr[i];
					//console.log("<%State%>" +":" + "<%Responsibility Team%>");
					if("<%Responsibility Team%>" == Object.keys(obj)[0]){
						var count = parseInt(obj["<%Responsibility Team%>"]);
						//console.log(count);
						obj["<%Responsibility Team%>"] = count+1;
						
					}
					//console.log(obj);
				}
			}
		} 
	}
	//Change Request数据 
    if("<%<%builtin Type%>%>" == "Change Request"  && Projects[Projects.length-1] == "<%<%builtin Project%>%>"){
		//Change Request State
		for(var key in ChangeRequestStateDate){ 
			var arr = ChangeRequestStateDate[key];
			for(var i = 0;i<arr.length;i++){
				var obj = arr[i];
				if("<%State%>" == Object.keys(obj)[0]){
					var count = parseInt(obj["<%State%>"]);
					//console.log(count);
					obj["<%State%>"] = count+1;
						
				}
				//console.log(obj);
			}
		}
		
		//Change Category and Change Initiator
		for(var key in ChangeRequestDate){ 
			if("<%Change Category%>" == key){
				var arr = ChangeRequestDate[key];
				for(var i = 0;i<arr.length;i++){
					var obj = arr[i];
					if("<%Change Initiator%>" == Object.keys(obj)[0]){
						var count = parseInt(obj["<%Change Initiator%>"]);
						//console.log(count);
						obj["<%Change Initiator%>"] = count+1;
						
					}
					//console.log(obj);
				}
			}
		}
	} 
	
	//Change Order数据   
    if("<%<%builtin Type%>%>" == "Change Order"  && Projects[Projects.length-1] == "<%<%builtin Project%>%>"){
		//Change Order State
		for(var key in ChangeOrderDate){ 
			var arr = ChangeOrderDate[key];
				for(var i = 0;i<arr.length;i++){
					var obj = arr[i];
					if("<%State%>" == Object.keys(obj)[0]){
						var count = parseInt(obj["<%State%>"]);
						//console.log(count);
						obj["<%State%>"] = count+1;
						
					}
					//console.log(obj);
				}
		}

	} 
	var ls = ProjectDate[Projects.length-1];
	console.log(ls);
	ProjectDate[Projects.length-1].DefectTypeData = DefectTypeData;
	ProjectDate[Projects.length-1].RiskDate = RiskDate;
	
	ProjectDate[Projects.length-1].TaskPhasData = TaskPhasData;
	ProjectDate[Projects.length-1].DefectStateDate = DefectStateDate;
	ProjectDate[Projects.length-1].DefectResponsibilityTeamDate = DefectResponsibilityTeamDate;
	ProjectDate[Projects.length-1].ChangeRequestStateDate = ChangeRequestStateDate;
	ProjectDate[Projects.length-1].ChangeRequestDate = ChangeRequestDate;
	ProjectDate[Projects.length-1].ChangeOrderDate = ChangeOrderDate;

	
</script>
<%enddetail%>
<div id = "projectDom" style = " margin-bottom:10px">
	
</div>

</body>
<script>
	 
	console.log(ProjectDate);
	 
	
	getProjectDate()
	
    //getRiskDate();
	//getDefectDate();
	//getTaskPhasData();
	//getDefectStateDate();
	//getDefectResponsibilityTeamDate();
	//getChangeRequestDate();
	//getChangeRequestStateDate();
	//getChangeOrderDate();
	
	//给html赋值
	function getDate(elm,date){
		//console.log(elm);
		//console.log(date);
		var html = '';
		for(var key in date){
			var html1 = '<tr class="odd_row" style="width: 100%;"><th style="text-align:right; width: 30%">'+key+ ':</th>';
			var html2 = "";
			var arr = date[key];
			for(var i =0;i<arr.length;i++){
				var obj = arr[i];
				//console.log(Object.keys(obj)[0]);
				//onsole.log(Object.values(obj)[0]);
			
				html2 += '<td style="text-align:center; "> '+Object.values(obj)[0]+'</td>';
			}			
			html += html1+html2+'</tr>';
		}
		elm.innerHTML = html;
	}
	
	function getDefectStateDate(elm,date){
		var html = '';
		for(var key in date){
			var name = "";
			if(key == "Open"){
				name = "Problem Definition";
			}else if(key == "In Testing"){
				name = "Validation and Closed";
			}else if(key == "In Progress"){
				name = "Execute Corrective Action";
			}else if(key == "In Analysis"){
				name = "Problem Confirmation";
			}else if(key == "Analyzed"){
				name = "Develop Inverstigation";
			}
			var html1 = '<tr class="odd_row" style="width: 100%;"><th style="text-align:right; width: 30%">'+name+ ':</th>';
			var html2 = "";
			var arr = date[key];
			for(var i =0;i<arr.length;i++){
				var obj = arr[i];
				//console.log(Object.keys(obj)[0]);
				//onsole.log(Object.values(obj)[0]);
			
				html2 += '<td style="text-align:center; "> '+Object.values(obj)[0]+'</td>';
			}			
			html += html1+html2+'</tr>';
		}
		elm.innerHTML = html;
	}
	
	
	function getProjectDate(){
		var html = '';
		//先加载所有dom
		for(var i = 0;i<ProjectDate.length;i++){
			var obj = ProjectDate[i].project;
			//console.log("sj---------:"+obj["ProjectIdA"]);
			html += '<p class="title">'+obj["projectType"]+' <a class="title" href="'+obj["ProjectIdA"]+'" target="_blank">'+obj["projectId"]+'</a>: '+obj["ProjectSummary"]+'</p>\n' +
        '<table class="detailrows fullWidth">\n' +
        '\t<tr>\n' +
        '\t\t<td style="width: 50%;">\n' +
        '\t\t\t<table class="detailrows" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th nowrap style="width: 30%;">State:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+obj["State"]+'</td>\n' +
        '\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th nowrap style="width: 30%;">ASIL:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+obj["ASIL"]+'</td>\n' +
        '\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th nowrap style="width: 30%;">Project Start Date:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+obj["Project Start Date"]+'</td>\n' +
        '\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th nowrap style="width: 30%;">Project End Date:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+obj["Project End Date"]+'</td>\n' +
        '\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th nowrap style="width: 30%;">Project Manager:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+obj["Project Manager"]+'</td>\n' +
        '\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th nowrap style="width: 15%;">TeamMembers:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+obj["TeamMembers"]+'</td>\n' +
        '\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t</table>\n' +
        '\t\t\t\n' +
        '\t\t</td>\n' +
        '\t\t<td style="vertical-align: top; width: 50%;">\n' +
        '\t\t\t<table class="detailrows" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th nowrap style="text-align:right; width: 30%;">Project Start:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+obj["Project Start"]+'</td>\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t\t<th nowrap style="text-align:right; width: 30%;">Project Acceptance:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+obj["Project Acceptance"]+'</td>\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t\t<th nowrap style="text-align:right; width: 30%;">Project Plan:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+obj["Project Plan"]+'</td>\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t\t<th nowrap style="text-align:right; width: 30%;">Functional Specification Freeze:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+obj["Functional Specification Freeze"]+'</td>\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t\t<th nowrap style="text-align:right; width: 30%;">Code Freeze:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%;">'+obj["Code Freeze"]+'</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t\t<th nowrap style="text-align:right; width: 30%; ">Development Complete:</th>\n' +
        '\t\t\t\t\t<td style="width: 70%; ">'+obj["Development Complete"]+'</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '\t<tr><td>&nbsp;</td></tr>\n' +
        '\t<tr><td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center"><b>Process Metrics</b></td></tr>\n' +
        '\t<tr>\n' +
        '\t\t<td style="width: 100%;" colspan="2">\n' +
        '\t\t\t<table class="detailcols" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row" style="width: 100%;">\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 40%" ></th>\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 15%" >Pending</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 15%" >Open</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 15%" >Closed</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 15%" >Total</th>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row" style="width: 100%;">\n' +
        '\t\t\t\t\t<th style="text-align:right; width: 40%">Stakeholder Requirement Documents:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center; width: 15%" >'+obj["Pending Stakeholder Requirement Document Count"]+'</td>\n' +
        '\t\t\t\t\t<td style="text-align:center; width: 15%">'+obj["Open Stakeholder Requirement Document Count"]+'</td>\n' +
        '\t\t\t\t\t<td style="text-align:center; width: 15%">'+obj["Close Stakeholder Requirement Document Count"]+'</td>\n' +
        '\t\t\t\t\t<td style="text-align:center; width: 15%">\n' +
        '\t\t\t\t\t\t'+obj["Total Stakeholder Requirement Document Count"]+'\n' +
        '\t\t\t\t\t</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">System Requirement Specification Documents:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Pending System Requirement Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Open System Requirement Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Closed System Requirement Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">\n' +
        '\t\t\t\t\t\t'+obj["Total System Requirement Specification Document Count"]+' \n' +
        '\t\t\t\t\t</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">System Architectural Design Specification Documents:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Pending System Architectural Design Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Open System Architectural Design Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Closed System Architectural Design Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">\n' +
        '\t\t\t\t\t\t'+obj["Total System Architectural Design Specification Document Count"]+' \n' +
        '\t\t\t\t\t</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Software Requirement Specification Documents:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Pending Software Requirement Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Open Software Requirement Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Closed Software Requirement Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">\n' +
        '\t\t\t\t\t\t'+obj["Total Software Requirement Specification Document Count"]+' \n' +
        '\t\t\t\t\t</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Software Architectural Design Specification Documents:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Pending Software Architectural Design Specification Document Count"]+'</td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Open Software Architectural Design Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Closed Software Architectural Design Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">\n' +
        '\t\t\t\t\t\t'+obj["Total Software Architectural Design Specification Document Count"]+' \n' +
        '\t\t\t\t\t</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Software Detail Design Specification Documents:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Pending Software Detail Design Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Open Software Detail Design Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Closed Software Detail Design Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">\n' +
        '\t\t\t\t\t\t'+obj["Total Software Detail Design Specification Document Count"]+' \n' +
        '\t\t\t\t\t</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Hardware Requirement Specification Documents:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Pending Hardware Requirement Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Open Hardware Requirement Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Closed Hardware Requirement Specification Document Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Total Hardware Requirement Specification Document Count"]+' \n' +
        '\t\t\t\t\t</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Models:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Pending Models Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Open Models Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Closed Models Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Total Models Count E"]+' </td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Test Objectives:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Pending Test Objective Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Open Test Objective Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Closed Test Objective Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Total Test Objective Count"]+'</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Test Plans:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Pending Test Plan Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Open Test Plan Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Closed Test Plan Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Total Test Plan Count E"]+' </td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Test Suites:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Pending Test Suite Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Open Test Suite Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Closed Test Suite Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Total Test Suite Count"]+' \n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t\t</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Test Sessions:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Pending Test Session Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Open Test Session Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Closed Test Session Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Total Test Session Count"]+' \n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t\t</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Defects:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Pending Defect Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Open Defect Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Closed Defect Count"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Total Defect Count"]+' </td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Tasks:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Pending Tasks Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Open Tasks Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Closed Tasks Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Total Tasks Count E"]+' </td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Change Requests:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Pending Change Request Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Open Change Request Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Closed Change Request Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Total Change Request Count E"]+' </td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Change Orders:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Pending Change Order Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Open Change Order Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Closed Change Order Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Total Change Order Count E"]+'</td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Releases:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Pending Releases Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Open Releases Count E"]+'</td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Closed Releases Count E"]+'</td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Total Releases Count E"]+' </td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="even_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Non-conformance Issues:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Pending Non-conformance Issues Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Open Non-conformance Issues Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Closed Non-conformance Issues Count E"]+'</td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Total Non-conformance Issues Count E"]+' </td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tr class="odd_row">\n' +
        '\t\t\t\t\t<th style="text-align:right">Supplier Monitor Tasks:</th>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Pending Supplier Monitor Tasks Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Open Supplier Monitor Tasks Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Closed Supplier Monitor Tasks Count E"]+' </td>\n' +
        '\t\t\t\t\t<td style="text-align:center">'+obj["Total Supplier Monitor Tasks Count E"]+' </td>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '\t<tr><td>&nbsp;</td></tr>\n' +
        '\t<tr><td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center"><b>Quality Metrics</b></td></tr>\n' +
        '\t<tr>\n' +
        '\t\t<td>\n' +
        '\t\t\t<table class="detailrows">\n' +
        '\t\t\t\t<tr class="even_row"><th nowrap>Total Planned Count:</th><td width="100%">'+obj["Total Planned Count Project"]+'</td></tr>\n' +
        '\t\t\t\t<tr class="odd_row"><th nowrap>Total Run Count:</th><td width="100%">'+obj["Total Run Count Project"]+' </td></tr>\n' +
        '\t\t\t\t<tr class="even_row"><th nowrap>Total Pass Count:</th><td width="100%">'+obj["Total Pass Count Project"]+' </td></tr>\n' +
        '\t\t\t\t<tr class="odd_row"><th nowrap>Total Fail Count:</th><td width="100%">'+obj["Total Fail Count Project"]+' </td></tr>\n' +
        '\t\t\t\t<tr class="even_row"><th nowrap>Total Other Count:</th><td width="100%">'+obj["Total Other Count Project"]+' </td></tr>\n' +
        '\t\t\t\t<tr class="odd_row"><th nowrap>Total Blocked Count:</th><td width="100%">'+obj["Total Blocked Count Project"]+' </td></tr>\n' +
        '\t\t\t\t<tr class="even_row"><th nowrap>Total Suspect Results Count:</th><td width="100%">'+obj["Total Suspect Results Count Project"]+' </td></tr>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t\t<td valign="top">\n' +
        '\t\t\t<table class="detailrows">\n' +
        '\t\t\t<tr><th nowrap>Total Run Percentage:</th><td>'+obj["Total Run Percentage Project"]+' </td></tr>\n' +
        '\t\t\t<tr><th nowrap>Total Pass Percentage of Run:</th><td>'+obj["Total Pass Percentage of Run Project"]+' </tr>\n' +
        '\t\t\t<tr><th nowrap>Total Pass Percentage of Planned:</th><td>'+obj["Total Pass Percentage of Planned Project"]+'</td></tr>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '</table>'+
		
		'<table class="detailrows fullWidth">\n' +
        '<!-- Risk start -->\n' +
        '\t<tr><td ><h2>Risk : </h2></td></tr>\n' +
        '\t<tr>\n' +
        '\t\t<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">\n' +
        '\t\t\t<b>Risk Metrics</b>\n' +
        '\t\t</td> \n' +
        '\t</tr>\n' +
        '\t<tr>\n' +
        '\t\t<td style="width: 100%;" colspan="2">\n' +
        '\t\t\t<table class="detailcols" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row" style="width: 100%;">\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 30%" ></th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Open</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >In Analysis</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Rejected</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Analyzed</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >In Monitoring</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Postponed</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Cloesd</th>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tbody id = "RiskState'+obj["projectId"]+'">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tbody>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '<!-- Risk end -->\n' +
        '\t\n' +
        '<!-- Defect start -->\n' +
        '\t<tr><td>&nbsp;</td></tr>\n' +
        '\t<tr><td ><h2>Defect : </h2></td></tr>\n' +
        '\t<tr>\n' +
        '\t\t<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">\n' +
        '\t\t\t<b>Defect Metrics</b>\n' +
        '\t\t</td> \n' +
        '\t</tr>\n' +
        '\t<tr>\n' +
        '\t\t<td style="width: 100%;" colspan="2">\n' +
        '\t\t\t<table class="detailcols" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row" style="width: 100%;">\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 30%" ></th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Requirement</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >System Architecture</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Software Architecture</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Software Detailed Design</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Code</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Test</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Software Integration</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >System Integration</th>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tbody id = "defectTypeAndSousce'+obj["projectId"]+'">\n' +
        '\t\t\t\t\t \n' +
        '\t\t\t\t</tbody>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '<!-- Defect end -->\n' +
        '\t\n' +
        '<!-- Defect Origin and Task Phase start -->\n' +
        '\t<tr><td>&nbsp;</td></tr>\n' +
        '\t<tr>\n' +
        '\t\t<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">\n' +
        '\t\t\t<b>Defect Origin and Task Phase</b>\n' +
        '\t\t</td> \n' +
        '\t</tr>\n' +
        '\t<tr>\n' +
        '\t\t<td style="width: 100%;" colspan="2">\n' +
        '\t\t\t<table class="detailcols" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row" style="width: 100%;">\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 30%" ></th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Open</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Pending</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Closed</th>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tbody id = "defectOriginAndTaskPhase'+obj["projectId"]+'">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tbody>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '<!-- Defect Origin and Task Phase end -->\n' +
        '\n' +
        '<!-- Defect State and defectState start -->\n' +
        '\t<tr><td>&nbsp;</td></tr>\n' +
        '\t<tr>\n' +
        '\t\t<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">\n' +
        '\t\t\t<b>Defect State and defectState</b>\n' +
        '\t\t</td> \n' +
        '\t</tr>\n' +
        '\t<tr>\n' +
        '\t\t<td style="width: 100%;" colspan="2">\n' +
        '\t\t\t<table class="detailcols" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row" style="width: 100%;">\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 30%" ></th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Not Delay</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Delay</th>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tbody id = "defectStateAndDefectState'+obj["projectId"]+'">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tbody>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '<!-- Defect State and defectState end -->\n' +
        '\n' +
        '<!-- Defect State and Responsibility Team start -->\n' +
        '\t<tr><td>&nbsp;</td></tr>\n' +
        '\t<tr>\n' +
        '\t\t<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">\n' +
        '\t\t\t<b>Defect State and Responsibility Team</b>\n' +
        '\t\t</td> \n' +
        '\t</tr>\n' +
        '\t<tr>\n' +
        '\t\t<td style="width: 100%;" colspan="2">\n' +
        '\t\t\t<table class="detailcols" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row" style="width: 100%;">\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 30%" ></th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >PM</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >STS</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >ASW</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >BSW</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >HW</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >TEST</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >QA</th>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tbody id = "defectStateAndResponsibilityTeam'+obj["projectId"]+'">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tbody>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '<!-- Defect State and Responsibility Team end -->\n' +
        '\n' +
        '\t\n' +
        '<!-- Change Request Change Category and Change Initiator start -->\n' +
        '\t<tr><td>&nbsp;</td></tr>\n' +
        '\t<tr><td ><h2>Change Request : </h2></td></tr>\n' +
        '\t<tr>\n' +
        '\t\t<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">\n' +
        '\t\t\t<b>Change Category and Change Initiator</b>\n' +
        '\t\t</td> \n' +
        '\t</tr>\n' +
        '\t<tr>\n' +
        '\t\t<td style="width: 100%;" colspan="2">\n' +
        '\t\t\t<table class="detailcols" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row" style="width: 100%;">\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 30%" ></th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Customer</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Supplier</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Internal</th>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tbody id = "ChangeCategoryAndChangeInitiator'+obj["projectId"]+'">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tbody>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '<!-- Change Request Change Category and Change Initiator end -->\n' +
        '\n' +
        '<!-- Change Request State start -->\n' +
        '\t<tr><td>&nbsp;</td></tr>\n' +
        '\t<tr>\n' +
        '\t\t<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">\n' +
        '\t\t\t<b>Change Request State</b>\n' +
        '\t\t</td> \n' +
        '\t</tr>\n' +
        '\t<tr>\n' +
        '\t\t<td style="width: 100%;" colspan="2">\n' +
        '\t\t\t<table class="detailcols" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row" style="width: 100%;">\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 30%" ></th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Open</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >In Progress</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Approveed</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Fixed</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Closed</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Rejected</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Cancelled</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Postponed</th>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tbody id = "ChangeRequestState'+obj["projectId"]+'">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tbody>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '<!-- Change Request State end -->\n' +
        '\n' +
        '<!-- Change Order State start -->\n' +
        '\t<tr><td>&nbsp;</td></tr>\n' +
        '\t<tr><td ><h2>Change Order : </h2></td></tr>\n' +
        '\t<tr>\n' +
        '\t\t<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">\n' +
        '\t\t\t<b>ChangeOrder State</b>\n' +
        '\t\t</td> \n' +
        '\t</tr>\n' +
        '\t<tr>\n' +
        '\t\t<td style="width: 100%;" colspan="2">\n' +
        '\t\t\t<table class="detailcols" style="width: 100%;">\n' +
        '\t\t\t\t<tr class="even_row" style="width: 100%;">\n' +
        '\t\t\t\t\t<th style="text-align:center; width: 30%" ></th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Open</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >In Development</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Verify</th>\n' +
        '\t\t\t\t\t<th style="text-align:center; " >Closed</th>\n' +
        '\t\t\t\t</tr>\n' +
        '\t\t\t\t<tbody id = "ChangeOrderState'+obj["projectId"]+'">\n' +
        '\t\t\t\t\t\n' +
        '\t\t\t\t</tbody>\n' +
        '\t\t\t</table>\n' +
        '\t\t</td>\n' +
        '\t</tr>\n' +
        '<!-- Change Order State end -->\n' +
        '\t\n' +
        '</table>'
		
		}

		document.getElementById("projectDom").innerHTML = html;
		
		//在给需要赋值的dom赋值
		for(var i = 0;i<ProjectDate.length;i++){
			var project1 = ProjectDate[i].project;
			var RiskDate1 = ProjectDate[i].RiskDate;
			var DefectTypeData1 = ProjectDate[i].DefectTypeData;
			var TaskPhasData1 = ProjectDate[i].TaskPhasData;
			var DefectStateDate1 = ProjectDate[i].DefectStateDate;
			var DefectResponsibilityTeamDate1 = ProjectDate[i].DefectResponsibilityTeamDate;
			var ChangeRequestStateDate1 = ProjectDate[i].ChangeRequestStateDate;
			var ChangeRequestDate1 = ProjectDate[i].ChangeRequestDate;
			var ChangeOrderDate1 = ProjectDate[i].ChangeOrderDate;
			
			
			getDate(document.getElementById("RiskState"+project1["projectId"]),RiskDate1);
			
			getDate(document.getElementById("defectTypeAndSousce"+project1["projectId"]),DefectTypeData1);
			getDate(document.getElementById("defectOriginAndTaskPhase"+project1["projectId"]),TaskPhasData1);
			getDefectStateDate(document.getElementById("defectStateAndDefectState"+project1["projectId"]),DefectStateDate1);
			getDate(document.getElementById("defectStateAndResponsibilityTeam"+project1["projectId"]),DefectResponsibilityTeamDate1);
			
			getDate(document.getElementById("ChangeCategoryAndChangeInitiator"+project1["projectId"]),ChangeRequestDate1);
			getDate(document.getElementById("ChangeRequestState"+project1["projectId"]),ChangeRequestStateDate1);
			
			getDate(document.getElementById("ChangeOrderState"+project1["projectId"]),ChangeOrderDate1);
		}
		 
		
	}
</script>
</html>
