<%version 1%>
<%description
<b>Data: </b>QA Report<br>
<b>Notes: </b>This report displays QA Report.<br>
%>
<%param
name="reporttitle"
type="String"
prompt="Report Title"
value="QA Report"
description="Descriptive title for your report."
%>
<%param
name="reportheader"
type="MultiString"
prompt="Report Header"
value=""
description="Text appearing at the top of the report page."
%>
<%param
name="reportfooter"
type="MultiString"
prompt="Report Footer"
value=""
description="Text appearing at the bottom of the report page."
%>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>&reporttitle</title>
    <%screenStyleSheet%>
    <%printerStyleSheet%>


    <script type="text/javascript">
		//所有需要统计的字段
		var data = {
			"State":[],
			"Responsibility Team":[],
			"Type":[],
			"Defect Source":[],
			"Defect Type":[],
			"Origin":[],
			"Task Phase":[],
			"defectState":[],
			"Change Category":[],
			"Change Initiator":[]
		};

		//project 数量
		var Projects =[];	
		//project type  
		var Area =["QA Task","Non-Conformance Issue","Document","Defect Source And Defect Type","Defect Origin And TaskPhase","Defect State And DefectState","Defect ResponsibilityTeam And State","ChangeRequestType","ChangeCategory And ChangeInitiator","ChangeOrderType","Test Plan","Test Objective","Test Session","Task","Supplier Monitor Task","Release","Risk","LL & BP"];		
	</script>
</head>
<%begindetail%>
<script type="text/javascript"> 
	if(Projects.indexOf("<%<%builtin Project%>%>") == -1){
		Projects.push("<%<%builtin Project%>%>");
	}

	//时间判断 如果没有Actual Start Date和Actual End Date 就已Created Date为准
	var proDate = "";
	if("<%Actual Start Date%>" != "" && "<%Actual End Date%>" != ""){
		proDate = "<%Actual Start Date%>-" + "<%Actual End Date%>"; 
	}else { 
		proDate = "<%Created Date%>"; 
	}
	var  StateDate = "<%State%>" == "&nbsp;"?"null":"<%State%>";
	data["State"].push({[StateDate]:["<%<%builtin Project%>%>","<%<%builtin Type%>%>",proDate]}); 
	
	var  ResponsibilityTeamDate = "<%Responsibility Team%>" == "&nbsp;"?"null":"<%Responsibility Team%>"; 
	data["Responsibility Team"].push({[ResponsibilityTeamDate]:["<%<%builtin Project%>%>","<%<%builtin Type%>%>",proDate]}); 
    
	var  TypeDate = "<%Type%>" == "&nbsp;"?"null":"<%Type%>";
	data["Type"].push({[TypeDate]:["<%<%builtin Project%>%>","<%<%builtin Type%>%>",proDate]}); 
	
	var  DefectSourceDate = "<%Defect Source%>" == "&nbsp;"?"null":"<%Defect Source%>";
	data["Defect Source"].push({[DefectSourceDate]:["<%<%builtin Project%>%>","<%<%builtin Type%>%>",proDate]}); 
	
	var  DefectTypeDate = "<%Defect Type%>" == "&nbsp;"?"null":"<%Defect Type%>";
	data["Defect Type"].push({[DefectTypeDate]:["<%<%builtin Project%>%>","<%<%builtin Type%>%>",proDate]}); 
	
	var  OriginDate = "<%Origin%>" == "&nbsp;"?"null":"<%Origin%>";
	data["Origin"].push({[OriginDate]:["<%<%builtin Project%>%>","<%<%builtin Type%>%>",proDate]}); 
	
	var  TaskPhaseDate = "<%Task Phase%>" == "&nbsp;"?"null":"<%Task Phase%>";
	data["Task Phase"].push({[TaskPhaseDate]:["<%<%builtin Project%>%>","<%<%builtin Type%>%>",proDate]}); 
	
	var  defectStateDate = "<%defectState%>" == "&nbsp;"?"null":"<%defectState%>";
	data["defectState"].push({[defectStateDate]:["<%<%builtin Project%>%>","<%<%builtin Type%>%>",proDate]}); 
	
	var  ChangeCategoryDate = "<%Change Category%>" == "&nbsp;"?"null":"<%Change Category%>";
	data["Change Category"].push({[ChangeCategoryDate]:["<%<%builtin Project%>%>","<%<%builtin Type%>%>",proDate]}); 
	
	var  ChangeInitiatorDate = "<%Change Initiator%>" == "&nbsp;"?"null":"<%Change Initiator%>";
	data["Change Initiator"].push({[ChangeInitiatorDate]:["<%<%builtin Project%>%>","<%<%builtin Type%>%>",proDate]}); 
		
</script>
<%enddetail%>
<div>
	<span class="spanRight">
		<strong>Project: </strong>
		<select class="selectProject" id="Project" name="Project" style="width:210px;height: 30px;" >
			<option value="all"> - Please Select - </option>
		</select>
	</span>
	<span class="spanRight">
		<strong>Area: </strong>
		<select class="selectArea" id="Area" name="Area" name="Area" style="width:210px;height: 30px;">
			<option value="all"> - Please Select - </option>
		</select>
	</span>
	<span class="spanRight">
		<strong>StartDate-EndDate:</strong>
		<input type="date" name="start_date" id="start_date"/>-
		<input type="date" name="end_date" id="end_date"/>
		<button  id="sub" onclick=submit();>Search by time</button>
	</span>	
</div>
<!--画表格-->
<div id = "projectDom" style = " margin-bottom:10px">

</div>

</body>
<script>
    console.log(data);  
		//统计数据
		var CountData = {}; 
	
		//QATask state统计
		var QATaskData = {
            "State":[{"Open":0},{"In Progress":0},{"Completed":0},{"Cancelled":0}]
    }	
		//Non-Conformance Issue   Responsibility Team统计
		var ResponsibilityTeamData = {
            "Open":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
            "In Progress":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
            "Verify":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
            "Closed":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
        }
		//Document Statistics    
		var DocumentDate ={
            "Open":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "InReview":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "Audit":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "In Approve":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "Published":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "Retired":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "Inactive":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}]
        }
		//Defect SourceAndType
		var SourceAndType = {
			 "Requirement":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "System Architecture":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "Software Architecture":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "Software Detailed Design":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "Code":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "Test":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "Software Integration":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "System Integration":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}] 
		}
		//Defect OriginAndTaskPhase  
		var OriginAndTaskPhase = {
			"Software Unit Test" : [{"Open":0},{"Pending":0},{"Closed":0}],
			"Software Integration Test" : [{"Open":0},{"Pending":0},{"Closed":0}],
			"Software Qulification Test" : [{"Open":0},{"Pending":0},{"Closed":0}],
			"System Integration Test" : [{"Open":0},{"Pending":0},{"Closed":0}],
			"System Qulification Test" : [{"Open":0},{"Pending":0},{"Closed":0}] 
		}
		//Defect StateAndDefectState 
		var StateAndDefectState = {
			"Open" : [{"false":0},{"true":0}],
			"In Testing" : [{"false":0},{"true":0}],
			"In Progress" : [{"false":0},{"true":0}],
			"In Analysis" : [{"false":0},{"true":0}],
			"Analyzed" : [{"false":0},{"true":0}] 
		}
		//Defect ResponsibilityTeamAndState  
		var ResponsibilityTeamAndState = {
			"PM" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"STS" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"ASW" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"BSW" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"HW" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"TEST" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"QA" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
		}
		// Change  ChangeRequestType   
		var ChangeRequestType = {
			"Change Request" : [{"Open":0},{"In Progress":0},{"Approveed":0},{"Fixed":0},{"Closed":0},{"Rejected":0},{"Cancelled":0},{"Postponed":0}] 
		}
		//Change ChangeCategoryAndChangeInitiator   
		var ChangeCategoryAndChangeInitiator = {
			"REQ Change" : [{"Customer":0},{"Supplier":0},{"Internal":0}],
			"Design Change" : [{"Customer":0},{"Supplier":0},{"Internal":0}],
			"Plan Change" : [{"Customer":0},{"Supplier":0},{"Internal":0}]
		}
		// Change ChangeOrderType 
		var ChangeOrderType = {
			"Change Order" : [{"Open":0},{"In Development":0},{"Verify":0},{"Closed":0}] 
		}
		//Test Statistics  Test Plan  
		var TestPlanType = {
			"Test Plan" : [{"Submit":0},{"In Testing":0},{"In Approve":0},{"Completed":0},{"Delay":0},{"Cancelled":0}] 
		}
		//Test Statistics  Test Objective
		var TestObjectiveType = {
			"Test Objective" : [{"Submit":0},{"In Testing":0},{"In Approve":0},{"Completed":0},{"Delay":0},{"Cancelled":0}] 
		}
		//Test Statistics    TestSession
		var TestSessionType = {
			"Test Session" : [{"Submit":0},{"In Testing":0},{"In Approve":0},{"Completed":0},{"Delay":0},{"Cancelled":0}] 
		}
		//Task   
		var TaskData = {
			"PM" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}],
			"STS" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}],
			"ASW" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}],
			"BSW" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}],
			"HW" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}], 
			"TEST" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}], 
			"QA" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}] 
		}
		//Supplier Monitor Task  
		var SupplierMonitorTaskData = {
			"PM" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}],
			"STS" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}],
			"ASW" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}],
			"BSW" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}],
			"HW" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}], 
			"TEST" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}],
			"QA" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}] 
		}
		//Release   
		var ReleaseData = {
			"Release" : [{"Open":0},{"In Progress":0},{"Audit":0},{"In Approve":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}] 
		}
		//Risk   
		var RiskData = {
			"Risk":[{"Open":0},{"In Analysis":0},{"Rejected":0},{"Analyzed":0},{"In Monitoring":0},{"Postponed":0},{"Cloesd":0}]
		}
		//LL & BP 
		var LLAndBPData = {
			"LL & BP" : [{"Open":0},{"In Analysis":0},{"Postponed":0},{"Rejected":0},{"Accepted":0},{"Published":0},{"Retired":0}] 
		} 
	
	//Projects下拉选
	var ProjectElm = document.getElementById("Project");
	for(var i = 0;i<Projects.length;i++){ 
	   var newItem = new Option(Projects[i],Projects[i]);   
	   ProjectElm.options.add(newItem); 
	   
	   //先给统计数据初始化
	   CountData[Projects[i]] = {};
	} 
    
	 //Projects下拉选改变事件 
	ProjectElm.onchange = function(){ 
    	// 通过对象获取value和text
        var ProjectVal = this.value;
		//var ProjectTitleId = ProjectVal.split("/")[1]+"Title";
		//var ProjectTable   = ProjectVal.split("/")[1]+"Table";
		
		xstr();//显示所有tr
		//区域设为请选择
		document.getElementById("Area").value = "all";
		
		xstable(ProjectVal);//显示隐藏table
		
	}
	
   //Projects type下拉选
   var AreaElm = document.getElementById("Area");
   for(var i = 0;i<Area.length;i++){ 
	   var newItem = new Option(Area[i],Area[i]);   
	   AreaElm.options.add(newItem);
   }
   //Projects type下拉选改变事件
   //var tr = document.getElementsByTagName("tr");
   var tr = document.getElementsByClassName("trls"); 
	AreaElm.onchange = function(){ 
		// 通过对象获取value和text
        var AreaVal = this.value;
		var proelm = document.getElementById("Project").value;
		//console.log(AreaVal);
		
		if(proelm == "all"){
			var ary = [];
			if(AreaVal == "all"){ 
				xstr();//显示所有tr
				xstable(proelm);//显示隐藏table
			}else {
				for(var i =0;i<Projects.length;i++){
				var proid = Projects[i].split("/")[1];
				 
				for(var j =0;j<tr.length;j++){
					if(tr[j].getAttribute("id") == proid+AreaVal || tr[j].getAttribute("id") == proid+AreaVal+" statistics" || ary.	  indexOf(tr[j].getAttribute("id")) > -1){
						ary.push(tr[j].getAttribute("id"));
						console.log(ary);
						tr[j].hidden = false;
					}else {
						tr[j].hidden = true;
					}
				}
				}
			}
			
		} else {
			if(AreaVal == "all"){
				//显示所有tr
				xstr();//显示所有tr
				xstable(proelm);//显示隐藏table
			}else {
				var proid = proelm.split("/")[1]; 
				for(var i =0;i<tr.length;i++){ 
				if(tr[i].getAttribute("id") == proid + AreaVal || tr[i].getAttribute("id") == proid + AreaVal+" statistics"){
					console.log(proid + AreaVal);
					console.log("id --"+tr[i].getAttribute("id"));
					console.log(tr[i]);
					
					tr[i].hidden = false;
				}else {
					tr[i].hidden = true;
				}
			}
			} 
		} 	
	}
	
	//按时间搜索 
	function submit(){
		var proDate = document.getElementById("sub");
		var satrtDate = document.getElementById("start_date").value;
		var endte = document.getElementById("end_date").value;
		console.log(satrtDate);
		console.log(endte);
		var proDate = [];
		proDate.push(satrtDate);
		proDate.push(endte);
		countDate(proDate)//统计数据
		console.log(proDate);
		console.log(CountData);
		getProjectDate();//加载DOM
	}
	
	countDate("")//统计数据
	console.log(CountData);
	getProjectDate();//加载DOM
		
	//显示隐藏table
	function xstable(ProjectVal){
		var title = document.getElementsByClassName("title");
		var table = document.getElementsByClassName("detailrows fullWidth");
		for(var i =0;i<title.length;i++){ 
			if(ProjectVal == "all"){ 
				title[i].hidden = false;
				table[i].hidden = false;
			}else if(ProjectVal.split("/")[1]+"Title" == title[i].getAttribute("id")){
				title[i].hidden = false;
				table[i].hidden = false;
			}else {
				title[i].hidden = true;
				table[i].hidden = true;
			}
		}
	}
	
	//显示所有tr
	function xstr(){  
		var alltr = document.getElementsByTagName("tr");
		for(var i =0;i<alltr.length;i++){
			alltr[i].hidden = false;
		}
	}
	
	//循环统计每个project的数据
	function countDate(proDate){
		for(var i = 0;i<Projects.length;i++){ 
		//每个project统计先清空
		QATaskData = {
            "State":[{"Open":0},{"In Progress":0},{"Completed":0},{"Cancelled":0}]
        }	
		ResponsibilityTeamData = {
            "Open":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
            "In Progress":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
            "Verify":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
            "Closed":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
        }
		DocumentDate ={
            "Open":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "InReview":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "Audit":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "In Approve":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "Published":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "Retired":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "Inactive":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}]
        }
		SourceAndType = {
			 "Requirement":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "System Architecture":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "Software Architecture":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "Software Detailed Design":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "Code":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "Test":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "Software Integration":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "System Integration":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}] 
		}
		OriginAndTaskPhase = {
			"Software Unit Test" : [{"Open":0},{"Pending":0},{"Closed":0}],
			"Software Integration Test" : [{"Open":0},{"Pending":0},{"Closed":0}],
			"Software Qulification Test" : [{"Open":0},{"Pending":0},{"Closed":0}],
			"System Integration Test" : [{"Open":0},{"Pending":0},{"Closed":0}],
			"System Qulification Test" : [{"Open":0},{"Pending":0},{"Closed":0}] 
		}
		StateAndDefectState = {
			"Open" : [{"false":0},{"true":0}],
			"In Testing" : [{"false":0},{"true":0}],
			"In Progress" : [{"false":0},{"true":0}],
			"In Analysis" : [{"false":0},{"true":0}],
			"Analyzed" : [{"false":0},{"true":0}] 
		}
		ResponsibilityTeamAndState = {
			"PM" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"STS" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"ASW" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"BSW" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"HW" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"TEST" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"QA" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
		}
		ChangeRequestType = {
			"Change Request" : [{"Open":0},{"In Progress":0},{"Approveed":0},{"Fixed":0},{"Closed":0},{"Rejected":0},{"Cancelled":0},{"Postponed":0}] 
		}
		ChangeCategoryAndChangeInitiator = {
			"REQ Change" : [{"Customer":0},{"Supplier":0},{"Internal":0}],
			"Design Change" : [{"Customer":0},{"Supplier":0},{"Internal":0}],
			"Plan Change" : [{"Customer":0},{"Supplier":0},{"Internal":0}]
		}
		ChangeOrderType = {
			"Change Order" : [{"Open":0},{"In Development":0},{"Verify":0},{"Closed":0}] 
		}
		TestPlanType = {
			"Test Plan" : [{"Submit":0},{"In Testing":0},{"In Approve":0},{"Completed":0},{"Delay":0},{"Cancelled":0}] 
		}
		TestObjectiveType = {
			"Test Objective" : [{"Submit":0},{"In Testing":0},{"In Approve":0},{"Completed":0},{"Delay":0},{"Cancelled":0}] 
		}
		TestSessionType = {
			"Test Session" : [{"Submit":0},{"In Testing":0},{"In Approve":0},{"Completed":0},{"Delay":0},{"Cancelled":0}] 
		}
		TaskData = {
			"PM" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}],
			"STS" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}],
			"ASW" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}],
			"BSW" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}],
			"HW" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}], 
			"TEST" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}], 
			"QA" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}] 
		}
		SupplierMonitorTaskData = {
			"PM" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}],
			"STS" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}],
			"ASW" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}],
			"BSW" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}],
			"HW" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}], 
			"TEST" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}],
			"QA" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}] 
		} 
		ReleaseData = {
			"Release" : [{"Open":0},{"In Progress":0},{"Audit":0},{"In Approve":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}] 
		}
		RiskData = {
			"Risk":[{"Open":0},{"In Analysis":0},{"Rejected":0},{"Analyzed":0},{"In Monitoring":0},{"Postponed":0},{"Cloesd":0}]
		} 
		LLAndBPData = {
			"LL & BP" : [{"Open":0},{"In Analysis":0},{"Postponed":0},{"Rejected":0},{"Accepted":0},{"Published":0},{"Retired":0}] 
		} 
	
   
	   infoData(QATaskData,"QATaskData",Projects[i],"QA Task",proDate);
	   infoData(ResponsibilityTeamData,"ResponsibilityTeamData",Projects[i],"Non-Conformance Issue",proDate);
	   infoData(DocumentDate,"DocumentDate",Projects[i],"All Document",proDate);
	   infoData(SourceAndType,"SourceAndType",Projects[i],"Defect",proDate);
	   infoData(OriginAndTaskPhase,"OriginAndTaskPhase",Projects[i],"Defect",proDate);
	   infoData(StateAndDefectState,"StateAndDefectState",Projects[i],"Defect",proDate);
	   infoData(ResponsibilityTeamAndState,"ResponsibilityTeamAndState",Projects[i],"Defect",proDate);
	   infoData(ChangeRequestType,"ChangeRequestType",Projects[i],"Change Request",proDate);
	   infoData(ChangeCategoryAndChangeInitiator,"ChangeCategoryAndChangeInitiator",Projects[i],"Change Request",proDate);
	   infoData(ChangeOrderType,"ChangeOrderType",Projects[i],"Change Order",proDate);
	   infoData(TestPlanType,"TestPlanType",Projects[i],"Test Plan",proDate);
	   infoData(TestObjectiveType,"TestObjectiveType",Projects[i],"Test Objective",proDate);
	   infoData(TestSessionType,"TestSessionType",Projects[i],"Test Session",proDate);
	   infoData(TaskData,"TaskData",Projects[i],"Task","");
	   infoData(SupplierMonitorTaskData,"SupplierMonitorTaskData",Projects[i],"Supplier Monitor Task",proDate);
	   infoData(ReleaseData,"ReleaseData",Projects[i],"Release",proDate);
	   infoData(RiskData,"RiskData",Projects[i],"Risk","");
	   infoData(LLAndBPData,"LLAndBPData",Projects[i],"LL & BP",proDate); 
	} 
	}

	
    //给定义好的统计数据赋值	
	function infoData(proData,proTypeName,project,projecttype,projectdate){
		var arr = Object.keys(proData);  
		//console.log(arr.length);  //3
		if(arr.length > 1){
			for(var key in proData){
			var pd = sjcl(project,projecttype,projectdate,key); //先判断横列有没有
			if(pd){
				var filed = proData[key];//数组 横列字段
				for(var i = 0;i<filed.length;i++){  // 竖列字段
					var obj = filed[i];  //对象
					var name = Object.keys(obj)[0];//key
					var pd = sjcl(project,projecttype,projectdate,name);//在判断竖列有没有
					if(pd){
						var count = parseInt(obj[name]); 
						obj[name] = count+1;
					}
				}
			}
			}
			
		}else {
			for(var  key in proData){
			var filed = proData[key];//数组 横列字段
				for(var i = 0;i<filed.length;i++){  // 竖列字段
					var obj = filed[i];  //对象
					var name = Object.keys(obj)[0];//key
					var pd = sjcl(project,projecttype,projectdate,name);
					if(pd){
						var count = parseInt(obj[name]);
						obj[name] = count+1;
					}
				}
			}
		}
		CountData[project][proTypeName] =  proData ;
		
	}
	
	//处理数据 根据条件查询数据有没有
	function sjcl(project,projecttype,projectdate,filedName){ 
		for(var key in data){
			var filed = data[key];//数组 
			for(var i =0;i<filed.length;i++){
				var filedsx = filed[i];  //对象
				var name = Object.keys(filedsx)[0];//key
				var value = filedsx[name];  //value 
				//if(value[2]==projectdate){ //时间单独判断
					if(name == filedName && value[0] == project && value[1]==projecttype){
						var ActualStartDate = "";
						var ActualEndDate =  "";
						var CreatedDate = "";
						var SatrtDate = "";
						var EndDate = ""; 
						if(projectdate != "" ){  //过滤条件 时间
							SatrtDate = projectdate[0];
							EndDate = projectdate[1];
						} 	
						if(value[2].split("-") > 1){ //大于一表示有Actual Start Date和Actual End Date
							var ActualStartDate = value[2].split("-")[0].split(" ")[0]; 
							var ActualEndDate = value[2].split("-")[1].split(" ")[0]; 
						}else {
							var CreatedDate = value[2].split(" ")[0];
					
						}
						//根据时间过滤
						if(SatrtDate != "" && EndDate != ""){
							if(ActualStartDate != "" && ActualEndDate !=""){
								if(ActualStartDate > SatrtDate && ActualEndDate < EndDate){
									return true;
								}
							}else {  //根据CreatedDate判断
								if(CreatedDate > SatrtDate && CreatedDate < EndDate){
									return true;
								}
							} 
						}else if(SatrtDate != "" ){
							if(ActualStartDate != ""){
								if(ActualStartDate > SatrtDate){
									return true;
								}
							}else {  //根据CreatedDate判断
								if(CreatedDate > SatrtDate){
									return true;
								}
							} 
						}else if(EndDate != ""){
							if(ActualEndDate !=""){
								if(ActualEndDate < EndDate){
									return true;
								}
							}else {  //根据CreatedDate判断
								if(ActualEndDate > EndDate){
									return true;
								}
							} 
						}else {
							return true;
						} 
					}
				//} 
			} 
		}
		return false;
	}
	
//给html赋值
	function getDate(elm,date){
		//console.log(elm);
		//console.log(date);
		var html = '';
		for(var key in date){
			var html1 = '<tr class="odd_row" style="width: 100%;"><th style="text-align:right; width: 30%">'+key+ ':</th>';
			var html2 = "";
			var arr = date[key];
			for(var i =0;i<arr.length;i++){
				var obj = arr[i];
				//console.log(Object.keys(obj)[0]);
				//onsole.log(Object.values(obj)[0]);
			
				html2 += '<td style="text-align:center; "> '+Object.values(obj)[0]+'</td>';
			}			
			html += html1+html2+'</tr>';
		}
		elm.innerHTML = html;
	}

	function getProjectDate(){
		var html = '';
		//先加载所有dom
		for(var key in CountData){
			var arr = CountData[key]; 
			var projectId = key.split("/")[1];
			//console.log("sj---------:"+obj["ProjectIdA"]);
			html += '<p class="title" id="'+key.split("/")[1]+'Title">'+ key +'</p>'+
					'<table class="detailrows fullWidth" id="'+key.split("/")[1]+'Table">'+
						'<tr id="'+projectId+'QA Task"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>QA Task statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'QA Task statistics" class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Open</th>'+
										'<th style="text-align:center; ">In Progress</th>'+
										'<th style="text-align:center; ">Completed</th>'+
										'<th style="text-align:center; ">Cancelled</th>'+
									'</tr>'+
									'<tbody id=QATaskData-'+key.split("/")[1]+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						'<tr id="'+projectId+'Non-Conformance Issue"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Non-Conformance Issue statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Non-Conformance Issue statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">PM</th>'+
										'<th style="text-align:center; ">STS</th>'+
										'<th style="text-align:center; ">ASW</th>'+
										'<th style="text-align:center; ">BSW</th>'+
										'<th style="text-align:center; ">HW</th>'+
										'<th style="text-align:center; ">TEST</th>'+
										'<th style="text-align:center; ">QA</th>'+
									'</tr>'+
									'<tbody id=ReponsibiltyTeam-'+key.split("/")[1]+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						'<tr id="'+projectId+'Document"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Document statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Document statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">System Requirement Specification Document</th>'+
										'<th style="text-align:center; ">System Architectural Design Specification Document</th>'+
										'<th style="text-align:center; ">Software Requirement Specification Document</th>'+
										'<th style="text-align:center; ">Software Architectural Design Specification Document</th>'+
										'<th style="text-align:center; ">Software Detail Design Specification Document</th>'+
										'<th style="text-align:center; ">Hardware Requirement Specification Document</th>'+
										'<th style="text-align:center; ">Hardware Design Document</th>'+
										'<th style="text-align:center; ">General Document</th>'+
										'<th style="text-align:center; ">Test Suite</th>'+
									'</tr>'+
									'<tbody id=Document-'+key.split("/")[1]+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						
						'<tr id="'+projectId+'Defect Source And Defect Type"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Defect Source And Defect Type statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Defect Source And Defect Type statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Function</th>'+
										'<th style="text-align:center; ">Logical</th>'+
										'<th style="text-align:center; ">Norms</th>'+
										'<th style="text-align:center; ">Interface</th>'+
										'<th style="text-align:center; ">Performance</th>'+
										'<th style="text-align:center; ">Gramer</th>'+
										'<th style="text-align:center; ">Design Defect</th>'+
									'</tr>'+
									'<tbody id=DefectSourceAndDefectType-'+key.split("/")[1]+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						'<tr id="'+projectId+'Defect Origin And TaskPhase"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Defect Origin And TaskPhase statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Defect Origin And TaskPhase statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Open</th>'+
										'<th style="text-align:center; ">Pending</th>'+
										'<th style="text-align:center; ">Closed</th>'+ 
									'</tr>'+
									'<tbody id=DefectOriginAndTaskPhase-'+key.split("/")[1]+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						'<tr id="'+projectId+'Defect State And DefectState"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Defect State And DefectState statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Defect State And DefectState statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Not Delay</th>'+
										'<th style="text-align:center; ">Delay</th>'+ 
									'</tr>'+
									'<tbody id=DefectStateAndDefectState-'+key.split("/")[1]+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+ 
						'<tr id="'+projectId+'Defect ResponsibilityTeam And State"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Defect ResponsibilityTeam And State statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Defect ResponsibilityTeam And State statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Open</th>'+
										'<th style="text-align:center; ">In Analysis</th>'+ 
										'<th style="text-align:center; ">Analyzed</th>'+ 
										'<th style="text-align:center; ">In Progress</th>'+ 
										'<th style="text-align:center; ">InTesting</th>'+ 
										'<th style="text-align:center; ">Verified</th>'+ 
										'<th style="text-align:center; ">Closed</th>'+ 
										'<th style="text-align:center; ">Rejected</th>'+ 
										'<th style="text-align:center; ">Postponed</th>'+ 
									'</tr>'+
									'<tbody id=DefectResponsibilityTeamAndState-'+key.split("/")[1]+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						
						'<tr id="'+projectId+'ChangeRequestType"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>ChangeRequestType statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'ChangeRequestType statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Open</th>'+
										'<th style="text-align:center; ">In Progress</th>'+ 
										'<th style="text-align:center; ">Approveed</th>'+ 
										'<th style="text-align:center; ">Fixed</th>'+ 
										'<th style="text-align:center; ">Closed</th>'+ 
										'<th style="text-align:center; ">Rejected</th>'+ 
										'<th style="text-align:center; ">Cancelled</th>'+ 
										'<th style="text-align:center; ">Postponed</th>'+  
									'</tr>'+
									'<tbody id=ChangeRequestType-'+key.split("/")[1]+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						'<tr id="'+projectId+'ChangeCategory And ChangeInitiator"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>ChangeCategory And ChangeInitiator statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'ChangeCategory And ChangeInitiator statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Customer</th>'+
										'<th style="text-align:center; ">Supplier</th>'+ 
										'<th style="text-align:center; ">Internal</th>'+
									'</tr>'+
									'<tbody id=ChangeCategoryAndChangeInitiator-'+key.split("/")[1]+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						'<tr id="'+projectId+'ChangeOrderType"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>ChangeOrderType statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'ChangeOrderType statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Open</th>'+
										'<th style="text-align:center; ">In Development</th>'+ 
										'<th style="text-align:center; ">Verify</th>'+ 
										'<th style="text-align:center; ">Closed</th>'+ 
									'</tr>'+
									'<tbody id=ChangeOrderType-'+key.split("/")[1]+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						
						'<tr id="'+projectId+'Test Plan"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Test Plan statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Test Plan statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Submit</th>'+
										'<th style="text-align:center; ">In Testing</th>'+ 
										'<th style="text-align:center; ">In Approve</th>'+ 
										'<th style="text-align:center; ">Completed</th>'+ 
										'<th style="text-align:center; ">Delay</th>'+ 
										'<th style="text-align:center; ">Cancelled</th>'+ 
									'</tr>'+
									'<tbody id=TestPlan-'+key.split("/")[1]+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						'<tr id="'+projectId+'Test Objective"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Test Objective statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Test Objective statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Submit</th>'+
										'<th style="text-align:center; ">In Testing</th>'+ 
										'<th style="text-align:center; ">In Approve</th>'+ 
										'<th style="text-align:center; ">Completed</th>'+ 
										'<th style="text-align:center; ">Delay</th>'+ 
										'<th style="text-align:center; ">Cancelled</th>'+ 
									'</tr>'+
									'<tbody id=TestObjective-'+key.split("/")[1]+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						'<tr id="'+projectId+'Test Session"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Test Session statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Test Session statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Submit</th>'+
										'<th style="text-align:center; ">In Testing</th>'+ 
										'<th style="text-align:center; ">In Approve</th>'+ 
										'<th style="text-align:center; ">Completed</th>'+ 
										'<th style="text-align:center; ">Delay</th>'+ 
										'<th style="text-align:center; ">Cancelled</th>'+ 
									'</tr>'+
									'<tbody id=TestSession-'+key.split("/")[1]+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						
						'<tr id="'+projectId+'Task"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Task statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Task statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Open</th>'+
										'<th style="text-align:center; ">In Development</th>'+ 
										'<th style="text-align:center; ">Completed</th>'+ 
										'<th style="text-align:center; ">Cancelled</th>'+
									'</tr>'+
									'<tbody id=Task-'+key.split("/")[1]+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						'<tr id="'+projectId+'Supplier Monitor Task"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Supplier Monitor Task statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Supplier Monitor Task statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Open</th>'+
										'<th style="text-align:center; ">In Progress</th>'+ 
										'<th style="text-align:center; ">In Review</th>'+ 
										'<th style="text-align:center; ">Audit</th>'+
										'<th style="text-align:center; ">Delivered</th>'+
										'<th style="text-align:center; ">Accepted</th>'+
										'<th style="text-align:center; ">Cancelled</th>'+
									'</tr>'+
									'<tbody id=SupplierMonitorTask-'+key.split("/")[1]+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						
						'<tr id="'+projectId+'Release"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Release statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Release statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Open</th>'+
										'<th style="text-align:center; ">In Progress</th>'+ 
										'<th style="text-align:center; ">Audit</th>'+ 
										'<th style="text-align:center; ">In Approve</th>'+
										'<th style="text-align:center; ">Delivered</th>'+
										'<th style="text-align:center; ">Accepted</th>'+
										'<th style="text-align:center; ">Cancelled</th>'+
									'</tr>'+
									'<tbody id=Release-'+key.split("/")[1]+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						
						'<tr id="'+projectId+'Risk"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Risk  statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Risk statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Open</th>'+
										'<th style="text-align:center; ">In Analysis</th>'+ 
										'<th style="text-align:center; ">Rejected</th>'+ 
										'<th style="text-align:center; ">Analyzed</th>'+
										'<th style="text-align:center; ">In Monitoring</th>'+
										'<th style="text-align:center; ">Postponed</th>'+
										'<th style="text-align:center; ">Cloesd</th>'+
									'</tr>'+
									'<tbody id=Risk-'+key.split("/")[1]+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						
						'<tr id="'+projectId+'LL & BP"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>LL & BP statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'LL & BP statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Open</th>'+
										'<th style="text-align:center; ">In Analysis</th>'+ 
										'<th style="text-align:center; ">Postponed</th>'+ 
										'<th style="text-align:center; ">Rejected</th>'+
										'<th style="text-align:center; ">Accepted</th>'+
										'<th style="text-align:center; ">Published</th>'+
										'<th style="text-align:center; ">Retired</th>'+
									'</tr>'+
									'<tbody id=LLAndBP-'+key.split("/")[1]+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
					'</table>'
		
		} 

		document.getElementById("projectDom").innerHTML = html;
		
		//在给需要赋值的dom赋值
		for(var key in CountData){
			var arr = CountData[key];
			 
			getDate(document.getElementById("QATaskData-"+key.split("/")[1]),arr["QATaskData"]);
			getDate(document.getElementById("ReponsibiltyTeam-"+key.split("/")[1]),arr["ResponsibilityTeamData"]);
			getDate(document.getElementById("Document-"+key.split("/")[1]),arr["DocumentDate"]);

			getDate(document.getElementById("DefectSourceAndDefectType-"+key.split("/")[1]),arr["SourceAndType"]);
			getDate(document.getElementById("DefectOriginAndTaskPhase-"+key.split("/")[1]),arr["OriginAndTaskPhase"]);
			getDate(document.getElementById("DefectStateAndDefectState-"+key.split("/")[1]),arr["StateAndDefectState"]);
			getDate(document.getElementById("DefectResponsibilityTeamAndState-"+key.split("/")[1]),arr["ResponsibilityTeamAndState"]);
			getDate(document.getElementById("ChangeRequestType-"+key.split("/")[1]),arr["ChangeRequestType"]);
			getDate(document.getElementById("ChangeCategoryAndChangeInitiator-"+key.split("/")[1]),arr["ChangeCategoryAndChangeInitiator"]);
			getDate(document.getElementById("ChangeOrderType-"+key.split("/")[1]),arr["ChangeOrderType"]);
			getDate(document.getElementById("TestPlan-"+key.split("/")[1]),arr["TestPlanType"]);
			getDate(document.getElementById("TestObjective-"+key.split("/")[1]),arr["TestObjectiveType"]);
			getDate(document.getElementById("TestSession-"+key.split("/")[1]),arr["TestSessionType"]);
			getDate(document.getElementById("Task-"+key.split("/")[1]),arr["TaskData"]);
			getDate(document.getElementById("SupplierMonitorTask-"+key.split("/")[1]),arr["SupplierMonitorTaskData"]);
			getDate(document.getElementById("Release-"+key.split("/")[1]),arr["ReleaseData"]);
			getDate(document.getElementById("Risk-"+key.split("/")[1]),arr["RiskData"]);
			getDate(document.getElementById("LLAndBP-"+key.split("/")[1]),arr["LLAndBPData"]);
			 
		}
		 
	}
	
</script>
</html>
