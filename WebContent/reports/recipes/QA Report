<%version 1%>
<%description
<b>Data: </b>QA Report<br>
<b>Notes: </b>This report displays QA Report.<br>
%>
<%param
name="reporttitle"
type="String"
prompt="Report Title"
value="QA Report"
description="Descriptive title for your report."
%>
<%param
name="reportheader"
type="MultiString"
prompt="Report Header"
value=""
description="Text appearing at the top of the report page."
%>
<%param
name="reportfooter"
type="MultiString"
prompt="Report Footer"
value=""
description="Text appearing at the bottom of the report page."
%>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>&reporttitle</title>
    <%screenStyleSheet%>
    <%printerStyleSheet%>


    <script type="text/javascript">
		//所有需要统计的字段
		var data = {
			"State":[],
			"Responsibility Team":[],
			"Type":[],
			"Defect Source":[],
			"Defect Type":[],
			"Origin":[],
			"Task Phase":[],
			"defectState":[],
			"Change Category":[],
			"Change Initiator":[]
		};

		//project 数量
		var Projects =[];	
		//projectSelect
		var ProjectSelect =[];	
		//project type  
		var Area =["QA Task","Non-Conformance Issue","Document","Defect Source And Defect Type","Defect Origin And TaskPhase","Defect State And DefectState","Defect ResponsibilityTeam And State","ChangeRequestType","ChangeCategory And ChangeInitiator","ChangeOrderType","Test Plan","Test Objective","Test Session","Task","Supplier Monitor Task","Release","Risk","LL & BP"];		
		
			//project 統計字段
		var QATaskDataInit = [];
		var ResponsibilityTeamDataInit = [];
		var DocumentDateInit = [];
		var SourceAndTypeInit = [];
		var OriginAndTaskPhaseInit = [];
		var StateAndDefectStateInit = [];
		var ResponsibilityTeamAndStateInit = [];
		var ChangeRequestTypeInit = [];
		var ChangeCategoryAndChangeInitiatorInit = [];
		var ChangeOrderTypeInit = [];
		var TestPlanTypeInit = [];
		var TestObjectiveTypeInit = [];
		var TestSessionTypeInit = [];
		var TaskDataInit = [];
		var SupplierMonitorTaskDataInit = [];
		var ReleaseDataInit = [];
		var RiskDataInit = [];
		var LLAndBPDataInit = [];
	</script>
</head>
<%begindetail%>
<script type="text/javascript"> 
	if(Projects.indexOf("<%<%builtin Project%>%>") == -1){
		Projects.push("<%<%builtin Project%>%>");
		ProjectSelect.push({"<%<%builtin ID%>%>":"<%<%builtin Project%>%>"});
	}

	//时间判断 如果没有Actual Start Date和Actual End Date 就已Created Date为准
	var proDate = "";
	if("<%Actual Start Date%>" != "" && "<%Actual End Date%>" != ""){
		proDate = "<%Actual Start Date%>-" + "<%Actual End Date%>"; 
	}else { 
		proDate = "<%Created Date%>"; 
	}
	
	if("<%<%builtin Type%>%>" == "QA Task"){
		 QATaskDataInit.push({"<%<%builtin Project%>%>":{"<%State%>":[proDate]}});
	}
	if("<%<%builtin Type%>%>" == "Non-Conformance Issue"){
		 ResponsibilityTeamDataInit.push({"<%<%builtin Project%>%>":{"<%State%>:<%Responsibility Team%>":[proDate]}});
	}
	if("<%<%builtin Type%>%>" == "Document"){
		  ChangeOrderDateInit.push({"<%<%builtin Project%>%>":{"<%State%>:<%Type%>":[proDate]}});
	}
	if("<%<%builtin Type%>%>" == "Defect"){
		  SourceAndTypeInit.push({"<%<%builtin Project%>%>":{"<%Defect Source%>:<%Defect Type%>":[proDate]}});
		  OriginAndTaskPhaseInit.push({"<%<%builtin Project%>%>":{"<%Origin%>:<%Task Phase%>":[proDate]}});
		  StateAndDefectStateInit.push({"<%<%builtin Project%>%>":{"<%State%>:<%defectState%>":[proDate]}});
		  ResponsibilityTeamAndStateInit.push({"<%<%builtin Project%>%>":{"<%Responsibility Team%>:<%State%>":[proDate]}});
	}
	if("<%<%builtin Type%>%>" == "Change Request"){
		  ChangeRequestTypeInit.push({"<%<%builtin Project%>%>":{"<%State%>":[proDate]}});
		  ChangeCategoryAndChangeInitiatorInit.push({"<%<%builtin Project%>%>":{"<%Change Category%>:<%Change Initiator%>":[proDate]}});
	}
	if("<%<%builtin Type%>%>" == "Change Order"){
		  ChangeOrderTypeInit.push({"<%<%builtin Project%>%>":{"<%State%>":[proDate]}});
	}
	if("<%<%builtin Type%>%>" == "Test Plan"){
		 TestPlanTypeInit.push({"<%<%builtin Project%>%>":{"<%State%>":[proDate]}});
	}
	if("<%<%builtin Type%>%>" == "Test Objective"){
		 TestObjectiveTypeInit.push({"<%<%builtin Project%>%>":{"<%State%>":[proDate]}});
	}
	if("<%<%builtin Type%>%>" == "Test Session"){
		 TestSessionTypeInit.push({"<%<%builtin Project%>%>":{"<%State%>":[proDate]}});
	} 
	if("<%<%builtin Type%>%>" == "Task"){
		  TaskDataInit.push({"<%<%builtin Project%>%>":{"<%Responsibility Team%>:<%State%>":[proDate]}});
	}
	if("<%<%builtin Type%>%>" == "Supplier Monitor Task"){
		  SupplierMonitorTaskDataInit.push({"<%<%builtin Project%>%>":{"<%Responsibility Team%>:<%State%>":[proDate]}});
	}
	if("<%<%builtin Type%>%>" == "Release"){
		  ReleaseDataInit.push({"<%<%builtin Project%>%>":{"<%State%>":[proDate]}});
	}
	if("<%<%builtin Type%>%>" == "Risk"){
		  RiskDataInit.push({"<%<%builtin Project%>%>":{"<%State%>":[proDate]}});
	}
	if("<%<%builtin Type%>%>" == "LL and BP" || "<%<%builtin Type%>%>" == "LL & BP"){
		  LLAndBPDataInit.push({"<%<%builtin Project%>%>":{"<%State%>":[proDate]}});
	}
	//console.log("type:"+"<%<%builtin Type%>%>") 
</script>
<%enddetail%>
<div>
	<span class="spanRight">
		<strong>Project: </strong>
		<select class="selectProject" id="Project" name="Project" style="width:210px;height: 30px;" >
			<option value="all"> - Please Select - </option>
		</select>
	</span>
	<span class="spanRight">
		<strong>Area: </strong>
		<select class="selectArea" id="Area" name="Area" name="Area" style="width:210px;height: 30px;">
			<option value="all"> - Please Select - </option>
		</select>
	</span>
	<span class="spanRight">
		<strong>StartDate-EndDate:</strong>
		<input type="date" name="start_date" id="start_date" style="width: 135px; height: 30px;"/>-
		<input type="date" name="end_date" id="end_date" style="width: 135px; height: 30px;"/>
		<button  id="sub" onclick=submit();>Search by time</button>
		<button  id="sub" onclick=Eliminate();>Eliminate</button>
	</span>	
</div>
<!--画表格-->
<div id = "projectDom" style = " margin-bottom:10px">

</div>

</body>
<script>
//统计有问题先看初始保存数据有没有问题
     console.log(QATaskDataInit);
     console.log(ResponsibilityTeamDataInit);
     console.log(DocumentDateInit);
     console.log(SourceAndTypeInit);
     console.log(OriginAndTaskPhaseInit);
     console.log(StateAndDefectStateInit);
     console.log(ResponsibilityTeamAndStateInit);
     console.log(ChangeRequestTypeInit);
     console.log(ChangeCategoryAndChangeInitiatorInit);
     console.log(ChangeOrderTypeInit);
     console.log(TestPlanTypeInit);
     console.log(TestObjectiveTypeInit);
     console.log(TestSessionTypeInit);
     console.log(TaskDataInit);
     console.log(SupplierMonitorTaskDataInit);
     console.log(ReleaseDataInit);
     console.log(RiskDataInit);
     console.log(LLAndBPDataInit);  
     console.log(ProjectSelect);  


	//设置时间不能大于当前时间  得到当前时间
	var date_now = new Date();
	//得到当前年份
	var year = date_now.getFullYear();
	//得到当前月份 
	var month = date_now.getMonth()+1 < 10 ? "0"+(date_now.getMonth()+1) : (date_now.getMonth()+1);
	//得到当前日子（多少号）
	var date = date_now.getDate() < 10 ? "0"+date_now.getDate() : date_now.getDate();
	//设置input标签的max属性 
	var divId = document.createAttribute("max"); //创建属性
	divId.value = year+"-"+month+"-"+date; //设置属性值
	document.getElementById("start_date").setAttributeNode(divId); // 添加属性 
	
    console.log(data);  
		//统计数据
		var CountData = {}; 
	
		//QATask state统计
		var QATaskData = {
            "State":[{"Open":0},{"In Progress":0},{"Completed":0},{"Cancelled":0}]
    }	
		//Non-Conformance Issue   Responsibility Team统计
		var ResponsibilityTeamData = {
            "Open":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
            "In Progress":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
            "Verify":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
            "Closed":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
        }
		//Document Statistics    
		var DocumentDate ={
            "Open":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "InReview":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "Audit":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "In Approve":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "Published":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "Retired":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "Inactive":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}]
        }
		//Defect SourceAndType
		var SourceAndType = {
			 "Requirement":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "System Architecture":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "Software Architecture":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "Software Detailed Design":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "Code":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "Test":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "Software Integration":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "System Integration":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}] 
		}
		//Defect OriginAndTaskPhase  
		var OriginAndTaskPhase = {
			"Software Unit Test" : [{"Open":0},{"Pending":0},{"Closed":0}],
			"Software Integration Test" : [{"Open":0},{"Pending":0},{"Closed":0}],
			"Software Qulification Test" : [{"Open":0},{"Pending":0},{"Closed":0}],
			"System Integration Test" : [{"Open":0},{"Pending":0},{"Closed":0}],
			"System Qulification Test" : [{"Open":0},{"Pending":0},{"Closed":0}] 
		}
		//Defect StateAndDefectState 
		var StateAndDefectState = {
			"Open" : [{"false":0},{"true":0}],
			"In Testing" : [{"false":0},{"true":0}],
			"In Progress" : [{"false":0},{"true":0}],
			"In Analysis" : [{"false":0},{"true":0}],
			"Analyzed" : [{"false":0},{"true":0}] 
		}
		//Defect ResponsibilityTeamAndState  
		var ResponsibilityTeamAndState = {
			"PM" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"SYS" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"ASW" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"BSW" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"HW" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"TEST" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"QA" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
		}
		// Change  ChangeRequestType   
		var ChangeRequestType = {
			"Change Request" : [{"Open":0},{"In Progress":0},{"Approved":0},{"Fixed":0},{"Closed":0},{"Rejected":0},{"Cancelled":0},{"Postponed":0}] 
		}
		//Change ChangeCategoryAndChangeInitiator   
		var ChangeCategoryAndChangeInitiator = {
			"REQ change" : [{"Customer":0},{"Supplier":0},{"Internal":0}],
			"Design change" : [{"Customer":0},{"Supplier":0},{"Internal":0}],
			"Plan change" : [{"Customer":0},{"Supplier":0},{"Internal":0}]
		}
		// Change ChangeOrderType 
		var ChangeOrderType = {
			"Change Order" : [{"Open":0},{"In Development":0},{"Verify":0},{"Closed":0}] 
		}
		//Test Statistics  Test Plan  
		var TestPlanType = {
			"Test Plan" : [{"Submit":0},{"In Testing":0},{"In Approve":0},{"Completed":0},{"Delay":0},{"Cancelled":0}] 
		}
		//Test Statistics  Test Objective
		var TestObjectiveType = {
			"Test Objective" : [{"Submit":0},{"In Testing":0},{"In Approve":0},{"Completed":0},{"Delay":0},{"Cancelled":0}] 
		}
		//Test Statistics    TestSession
		var TestSessionType = {
			"Test Session" : [{"Submit":0},{"In Testing":0},{"In Approve":0},{"Completed":0},{"Delay":0},{"Cancelled":0}] 
		}
		//Task   
		var TaskData = {
			"PM" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}],
			"SYS" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}],
			"ASW" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}],
			"BSW" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}],
			"HW" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}], 
			"TEST" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}], 
			"QA" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}] 
		}
		//Supplier Monitor Task  
		var SupplierMonitorTaskData = {
			"PM" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}],
			"SYS" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}],
			"ASW" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}],
			"BSW" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}],
			"HW" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}], 
			"TEST" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}],
			"QA" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}] 
		}
		//Release   
		var ReleaseData = {
			"Release" : [{"Open":0},{"In Progress":0},{"Audit":0},{"In Approve":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}] 
		}
		//Risk   
		var RiskData = {
			"Risk":[{"Open":0},{"In Analysis":0},{"Rejected":0},{"Analyzed":0},{"In Monitoring":0},{"Postponed":0},{"Closed":0}]
		}
		//LL & BP 
		var LLAndBPData = {
			"LL & BP" : [{"Open":0},{"In Analysis":0},{"Postponed":0},{"Rejected":0},{"Accepted":0},{"Published":0},{"Retired":0}] 
		} 
	
	//Projects下拉选
	var ProjectElm = document.getElementById("Project");  
	for(var i=0;i<ProjectSelect.length;i++){
		var obj = ProjectSelect[i];
		var projectId = Object.keys(obj)[0];  
		var projectValue = obj[projectId]; 
		var newItem = new Option(projectValue,projectId);   
	    ProjectElm.options.add(newItem); 
	   
	   //先给统计数据初始化
	   CountData[Projects[i]] = {}; 
	}
    
	 //Projects下拉选改变事件 
	ProjectElm.onchange = function(){ 
    	// 通过对象获取value和text
        var ProjectVal = this.value;
		//var ProjectTitleId = ProjectVal.split("/")[1]+"Title";
		//var ProjectTable   = ProjectVal.split("/")[1]+"Table";
		
		xstr();//显示所有tr
		//区域设为请选择
		document.getElementById("Area").value = "all";
		
		xstable(ProjectVal);//显示隐藏table
		
	}
	
   //Projects type下拉选
   var AreaElm = document.getElementById("Area");
   for(var i = 0;i<Area.length;i++){ 
	   var newItem = new Option(Area[i],Area[i]);   
	   AreaElm.options.add(newItem);
   }
   //Projects type下拉选改变事件
   //var tr = document.getElementsByTagName("tr");
   var tr = document.getElementsByClassName("trls"); 
	AreaElm.onchange = function(){ 
		// 通过对象获取value和text
        var AreaVal = this.value;
		var proelm = document.getElementById("Project").value;
		console.log(AreaVal);
		
		if(proelm == "all"){
			var ary = [];
			if(AreaVal == "all"){ 
				xstr();//显示所有tr
				xstable(proelm);//显示隐藏table
			}else {
				for(var i=0;i<ProjectSelect.length;i++){
					var obj = ProjectSelect[i];
					var proid = Object.keys(obj)[0];   
					for(var j =0;j<tr.length;j++){
						if(tr[j].getAttribute("id") == proid+AreaVal || tr[j].getAttribute("id") == proid+AreaVal+" statistics" || ary.	  indexOf(tr[j].getAttribute("id")) > -1){
							ary.push(tr[j].getAttribute("id"));
						//console.log(ary);
							tr[j].hidden = false;
						}else {
							tr[j].hidden = true;
						}
					}
				} 
			}
			
		} else {
			if(AreaVal == "all"){
				//显示所有tr
				xstr();//显示所有tr
				xstable(proelm);//显示隐藏table
			}else {
				var proid = proelm;
				for(var i =0;i<tr.length;i++){ 
				if(tr[i].getAttribute("id") == proid + AreaVal || tr[i].getAttribute("id") == proid + AreaVal+" statistics"){
					//console.log(proid + AreaVal);
					//console.log("id --"+tr[i].getAttribute("id"));
					//console.log(tr[i]);
					
					tr[i].hidden = false;
				}else {
					tr[i].hidden = true;
				}
			}
			} 
		} 	
	}
	
	//按时间搜索 
	function submit(){
		var proDate = document.getElementById("sub");
		var satrtDate = document.getElementById("start_date").value;
		var endte = document.getElementById("end_date").value;
		console.log(satrtDate);
		console.log(endte);
		if(satrtDate == "" && endte == ""){
			alert("Please select a time first!"); 
		} else {
			var proDate = [];
			proDate.push(satrtDate);
			proDate.push(endte);
			countDate(proDate)//统计数据
			console.log(proDate);
			console.log(CountData);
			getProjectDate();//加载DOM
		
			var tj1 = document.getElementById("Project");
			var tj2 = document.getElementById("Area");
			if(tj1.value !="all"){
				//隐藏处选中的所有table 
				xstable(tj1.value);
			}
		
			if(tj2.value !="all"){
				//隐藏除选中的所有tr
				var tr1 = document.getElementsByClassName("trls"); 
				var Area1 = tj2.value;
				var proelm = tj1.value; 
				if(proelm == "all"){
					var ary = [];
					for(var i=0;i<ProjectSelect.length;i++){
						var obj = ProjectSelect[i];
						var proid = Object.keys(obj)[0];
						for(var j =0;j<tr1.length;j++){
							if(tr1[j].getAttribute("id") == proid+Area1 || tr1[j].getAttribute("id") == proid+Area1+" statistics" || ary.	  indexOf(tr1[j].getAttribute("id")) > -1){
								ary.push(tr1[j].getAttribute("id"));
								//console.log(ary);
								tr1[j].hidden = false;
							}else {
								tr1[j].hidden = true;
							}
						}						
					}
					 
				} else {
					var proid = proelm;  
					for(var i =0;i<tr1.length;i++){ 
						if(tr1[i].getAttribute("id") == proid + Area1 || tr1[i].getAttribute("id") == proid + Area1+" statistics"){ 
							tr1[i].hidden = false;
						}else {
							tr1[i].hidden = true;
						}
					} 
				}
			} 
		}
		
	}
	//清除时间搜索 
	function Eliminate(){ 
		document.getElementById("Project").value = "all";
		document.getElementById("Area").value = "all";
		document.getElementById("start_date").value = "";
		document.getElementById("end_date").value = "";
		countDate("")//统计数据
		console.log(proDate);
		console.log(CountData);
		getProjectDate();//加载DOM
	}
	
	countDate("")//统计数据
	console.log(CountData);
	getProjectDate();//加载DOM
		
	//显示隐藏table
	function xstable(ProjectVal){
		var title = document.getElementsByClassName("title");
		var table = document.getElementsByClassName("detailrows fullWidth");
		var proid = ProjectVal;  
		console.log("Title : "+proid+"Title"); 
		
		for(var i =0;i<title.length;i++){ 
			if(ProjectVal == "all"){ 
				title[i].hidden = false;
				table[i].hidden = false;
			}else if(proid +"Title" == title[i].getAttribute("id")){
				title[i].hidden = false;
				table[i].hidden = false;
			}else {
				title[i].hidden = true;
				table[i].hidden = true;
			}
		}
	}
	
	//显示所有tr
	function xstr(){  
		var alltr = document.getElementsByTagName("tr");
		for(var i =0;i<alltr.length;i++){
			alltr[i].hidden = false;
		}
	}
	
	//循环统计每个project的数据
	function countDate(proDate){
		for(var i = 0;i<Projects.length;i++){ 
		//每个project统计先清空
		QATaskData = {
            "State":[{"Open":0},{"In Progress":0},{"Completed":0},{"Cancelled":0}]
        }	
		ResponsibilityTeamData = {
            "Open":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
            "In Progress":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
            "Verify":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
            "Closed":[{"PM":0},{"STS":0},{"ASW":0},{"BSW":0},{"HW":0},{"TEST":0},{"QA":0}],
        }
		DocumentDate ={
            "Open":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "InReview":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "Audit":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "In Approve":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "Published":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "Retired":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}],
            "Inactive":[{"System Requirement Specification Document":0},
                {"System Architectural Design Specification Document":0},
                {"Software Requirement Specification Document":0},
                {"Software Architectural Design Specification Document":0},
                {"Software Detail Design Specification Document":0},
                {"Hardware Requirement Specification Document":0},
                {"Hardware Design Document":0},
                {"General Document":0},
                {"Test Suite":0}]
        }
		SourceAndType = {
			 "Requirement":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "System Architecture":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "Software Architecture":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "Software Detailed Design":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "Code":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "Test":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "Software Integration":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}],
			 "System Integration":[{"Function":0},{"Logical":0},{"Norms":0},{"Interface":0},{"Performance":0},{"Gramer":0},{"Design Defect":0}] 
		}
		OriginAndTaskPhase = {
			"Software Unit Test" : [{"Open":0},{"Pending":0},{"Closed":0}],
			"Software Integration Test" : [{"Open":0},{"Pending":0},{"Closed":0}],
			"Software Qulification Test" : [{"Open":0},{"Pending":0},{"Closed":0}],
			"System Integration Test" : [{"Open":0},{"Pending":0},{"Closed":0}],
			"System Qulification Test" : [{"Open":0},{"Pending":0},{"Closed":0}] 
		}
		StateAndDefectState = {
			"Open" : [{"false":0},{"true":0}],
			"In Testing" : [{"false":0},{"true":0}],
			"In Progress" : [{"false":0},{"true":0}],
			"In Analysis" : [{"false":0},{"true":0}],
			"Analyzed" : [{"false":0},{"true":0}] 
		}
		ResponsibilityTeamAndState = {
			"PM" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"SYS" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"ASW" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"BSW" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"HW" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"TEST" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
			"QA" : [{"Open":0},{"In Analysis":0},{"Analyzed":0},{"In Progress":0},{"InTesting":0},{"Verified":0},{"Closed":0},{"Rejected":0},{"Postponed":0}],
		}
		ChangeRequestType = {
			"Change Request" : [{"Open":0},{"In Progress":0},{"Approved":0},{"Fixed":0},{"Closed":0},{"Rejected":0},{"Cancelled":0},{"Postponed":0}] 
		}
		ChangeCategoryAndChangeInitiator = {
			"REQ change" : [{"Customer":0},{"Supplier":0},{"Internal":0}],
			"Design change" : [{"Customer":0},{"Supplier":0},{"Internal":0}],
			"Plan change" : [{"Customer":0},{"Supplier":0},{"Internal":0}]
		}
		ChangeOrderType = {
			"Change Order" : [{"Open":0},{"In Development":0},{"Verify":0},{"Closed":0}] 
		}
		TestPlanType = {
			"Test Plan" : [{"Submit":0},{"In Testing":0},{"In Approve":0},{"Completed":0},{"Delay":0},{"Cancelled":0}] 
		}
		TestObjectiveType = {
			"Test Objective" : [{"Submit":0},{"In Testing":0},{"In Approve":0},{"Completed":0},{"Delay":0},{"Cancelled":0}] 
		}
		TestSessionType = {
			"Test Session" : [{"Submit":0},{"In Testing":0},{"In Approve":0},{"Completed":0},{"Delay":0},{"Cancelled":0}] 
		}
		TaskData = {
			"PM" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}],
			"SYS" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}],
			"ASW" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}],
			"BSW" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}],
			"HW" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}], 
			"TEST" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}], 
			"QA" : [{"Open":0},{"In Development":0},{"Completed":0},{"Cancelled":0}] 
		}
		SupplierMonitorTaskData = {
			"PM" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}],
			"SYS" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}],
			"ASW" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}],
			"BSW" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}],
			"HW" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}], 
			"TEST" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}],
			"QA" : [{"Open":0},{"In Progress":0},{"In Review":0},{"Audit":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}] 
		} 
		ReleaseData = {
			"Release" : [{"Open":0},{"In Progress":0},{"Audit":0},{"In Approve":0},{"Delivered":0},{"Accepted":0},{"Cancelled":0}] 
		}
		RiskData = {
			"Risk":[{"Open":0},{"In Analysis":0},{"Rejected":0},{"Analyzed":0},{"In Monitoring":0},{"Postponed":0},{"Closed":0}]
		} 
		LLAndBPData = {
			"LL & BP" : [{"Open":0},{"In Analysis":0},{"Postponed":0},{"Rejected":0},{"Accepted":0},{"Published":0},{"Retired":0}] 
		} 
	
       //参数1 自定义统计数据  2统计数据名字  3，priject类型 4.查询的总数据 5查询时间 
	   dlsjtj(QATaskData,"QATaskData",Projects[i],QATaskDataInit,proDate);
	   slsjtj(ResponsibilityTeamData,"ResponsibilityTeamData",Projects[i],ResponsibilityTeamDataInit,proDate);
	   slsjtj(DocumentDate,"DocumentDate",Projects[i],DocumentDateInit,proDate);
	   slsjtj(SourceAndType,"SourceAndType",Projects[i],SourceAndTypeInit,proDate);
	   slsjtj(OriginAndTaskPhase,"OriginAndTaskPhase",Projects[i],OriginAndTaskPhaseInit,proDate);
	   slsjtj(StateAndDefectState,"StateAndDefectState",Projects[i],StateAndDefectStateInit,proDate);
	   slsjtj(ResponsibilityTeamAndState,"ResponsibilityTeamAndState",Projects[i],ResponsibilityTeamAndStateInit,proDate);
	   dlsjtj(ChangeRequestType,"ChangeRequestType",Projects[i],ChangeRequestTypeInit,proDate);
	   slsjtj(ChangeCategoryAndChangeInitiator,"ChangeCategoryAndChangeInitiator",Projects[i],ChangeCategoryAndChangeInitiatorInit,proDate);
	   dlsjtj(ChangeOrderType,"ChangeOrderType",Projects[i],ChangeOrderTypeInit,proDate);
	   dlsjtj(TestPlanType,"TestPlanType",Projects[i],TestPlanTypeInit,proDate);
	   dlsjtj(TestObjectiveType,"TestObjectiveType",Projects[i],TestObjectiveTypeInit,proDate);
	   dlsjtj(TestSessionType,"TestSessionType",Projects[i],TestSessionTypeInit,proDate);
	   slsjtj(TaskData,"TaskData",Projects[i],TaskDataInit,proDate);
	   slsjtj(SupplierMonitorTaskData,"SupplierMonitorTaskData",Projects[i],SupplierMonitorTaskDataInit,proDate);
	   dlsjtj(ReleaseData,"ReleaseData",Projects[i],ReleaseDataInit,proDate);
	   dlsjtj(RiskData,"RiskData",Projects[i],RiskDataInit,proDate);
	   dlsjtj(LLAndBPData,"LLAndBPData",Projects[i],LLAndBPDataInit,proDate); 
	} 
	}
	
	//多列数据统计
	function slsjtj(zdysj,proTypeName,projectType,cxsj,proDate){
		for(key in zdysj){
			var arr = zdysj[key];
			for(var i =0;i<arr.length;i++){
				var obj = arr[i];
				var name = Object.keys(obj)[0];   
				var value = obj[name];
				var allname = key+":"+name;
				var sl = sjtj(allname,projectType,cxsj,proDate); 
				var count = parseInt(value); 
				obj[name] = count+sl;
			}
		}
		CountData[projectType][proTypeName] =  zdysj;
	}
 
	//单列数据统计
    function dlsjtj(zdysj,proTypeName,projectType,cxsj,proDate){
		var arr = zdysj[Object.keys(zdysj)[0]];
		for(var i=0;i<arr.length;i++){
			var obj = arr[i];
			var name = Object.keys(obj)[0];  
			var value = obj[name];
			var sl = sjtj(name,projectType,cxsj,proDate)
			var count = parseInt(value); 
			obj[name] = count+sl;
		}
		CountData[projectType][proTypeName] =  zdysj ;
	}	
	 console.log("----");
	 
	 //根据查询数据计算数量
	function sjtj(key,projectType,cxsj,proDate){
		var count =0;
		for(var i =0;i<cxsj.length;i++){
			var obj = cxsj[i];
			var name = Object.keys(obj)[0];  
			var obj1 = obj[name];
			
			var value = Object.keys(obj1)[0]; 
			var pDate = obj1[value];
			            
			if(key == value && projectType == name){
				var ActualStartDate = "";
						var ActualEndDate =  "";
						var CreatedDate = "";
						var SatrtDate = "";
						var EndDate = ""; 
						if(proDate != "" ){  //过滤条件 时间
							SatrtDate = proDate[0];
							EndDate = proDate[1];
						} 	
						 
						var ls = pDate.toString();
						if(ls.split("-") > 1){ //大于一表示有Actual Start Date和Actual End Date
							var ActualStartDate = ls.split("-")[0].split(" ")[0]; 
							var ActualEndDate = ls.split("-")[1].split(" ")[0]; 
						}else {
							var CreatedDate = ls.split(" ")[0];
					
						}
						//根据时间过滤
						if(SatrtDate != "" && EndDate != ""){
							if(ActualStartDate != "" && ActualEndDate !=""){
								if(new Date(ActualStartDate).getTime() > new Date(SatrtDate).getTime() && new Date(ActualEndDate).getTime() <= new Date(EndDate).getTime()){
									count++;
								}
							}else {  //根据CreatedDate判断
								if(new Date(CreatedDate).getTime() > new Date(SatrtDate).getTime() && new Date(CreatedDate).getTime() <=new Date(EndDate).getTime()){
									count++;
								}
							} 
						}else if(SatrtDate != "" ){
							if(ActualStartDate != ""){
								if(new Date(ActualStartDate).getTime() > new Date(SatrtDate).getTime()){  
									count++;
								}
							}else {  //根据CreatedDate判断
								if(new Date(CreatedDate).getTime() > new Date(SatrtDate).getTime()){
									count++;
								}
							} 
						}else if(EndDate != ""){
							if(ActualEndDate !=""){
								if(new Date(ActualEndDate).getTime() <= new Date(EndDate).getTime()){
									count++;
								}
							}else {  //根据CreatedDate判断
								if(new Date(CreatedDate).getTime() <= new Date(EndDate).getTime()){
									count++;
								}
							} 
						}else {
							count++;
						} 
				
			}	
		}
		return count;
	} 
	 
	
//给html赋值
	function getDate(elm,date){
		if(elm == null)
			return;
		//console.log(elm);
		//console.log(date);
		var html = '';
		for(var key in date){
			var html1 = '<tr class="odd_row" style="width: 100%;"><th style="text-align:right; width: 30%">'+key+ ':</th>';
			var html2 = "";
			var arr = date[key];
			for(var i =0;i<arr.length;i++){
				var obj = arr[i];
				//console.log(Object.keys(obj)[0]);
				//onsole.log(Object.values(obj)[0]);
			
				html2 += '<td style="text-align:center; "> '+Object.values(obj)[0]+'</td>';
			}			
			html += html1+html2+'</tr>';
		}
		elm.innerHTML = html==''?"<br/>":html;
	}
	
	function getDefectStateDate(elm,date){
		if(elm == null)
			return;
		var html = '';
		for(var key in date){
			var name = "";
			if(key == "Open"){
				name = "Problem Definition";
			}else if(key == "In Testing"){
				name = "Validation and Closed";
			}else if(key == "In Progress"){
				name = "Execute Corrective Action";
			}else if(key == "In Analysis"){
				name = "Problem Confirmation";
			}else if(key == "Analyzed"){
				name = "Develop Inverstigation";
			}
			var html1 = '<tr class="odd_row" style="width: 100%;"><th style="text-align:right; width: 30%">'+name+ ':</th>';
			var html2 = "";
			var arr = date[key];
			for(var i =0;i<arr.length;i++){
				var obj = arr[i];
				//console.log(Object.keys(obj)[0]);
				//onsole.log(Object.values(obj)[0]);
			
				html2 += '<td style="text-align:center; "> '+Object.values(obj)[0]+'</td>';
			}			
			html += html1+html2+'</tr>';
		}
		//elm.innerHTML = html;
		elm.innerHTML = html==''?"<br/>":html;
	}
	
	//根据名字获取projectid
	function getProjectIdByName(projectName){
		var projectId = "";
		for(var i =0;i<ProjectSelect.length;i++){
			var obj = ProjectSelect[i];
			var name = Object.keys(obj)[0];  
			var value = obj[name];
			if(value == projectName){
				projectId = name;
				return projectId;
			}
		}
		return projectId;
	}

	function getProjectDate(){
		var html = '';
		//先加载所有dom
		for(var key in CountData){
			var arr = CountData[key]; 
			var projectId = getProjectIdByName(key);
			 console.log("projectId====== " + projectId);
			//console.log("sj---------:"+obj["ProjectIdA"]);
			html += '<p class="title" id="'+projectId+'Title">'+ key +'</p>'+
					'<table class="detailrows fullWidth" id="'+projectId+'Table">'+
						'<tr id="'+projectId+'QA Task"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>QA Task statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'QA Task statistics" class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Open</th>'+
										'<th style="text-align:center; ">In Progress</th>'+
										'<th style="text-align:center; ">Completed</th>'+
										'<th style="text-align:center; ">Cancelled</th>'+
									'</tr>'+
									'<tbody id=QATaskData-'+projectId+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						'<tr id="'+projectId+'Non-Conformance Issue"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Non-Conformance Issue statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Non-Conformance Issue statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">PM</th>'+
										'<th style="text-align:center; ">STS</th>'+
										'<th style="text-align:center; ">ASW</th>'+
										'<th style="text-align:center; ">BSW</th>'+
										'<th style="text-align:center; ">HW</th>'+
										'<th style="text-align:center; ">TEST</th>'+
										'<th style="text-align:center; ">QA</th>'+
									'</tr>'+
									'<tbody id=ReponsibiltyTeam-'+projectId+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						'<tr id="'+projectId+'Document"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Document statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Document statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">System Requirement Specification Document</th>'+
										'<th style="text-align:center; ">System Architectural Design Specification Document</th>'+
										'<th style="text-align:center; ">Software Requirement Specification Document</th>'+
										'<th style="text-align:center; ">Software Architectural Design Specification Document</th>'+
										'<th style="text-align:center; ">Software Detail Design Specification Document</th>'+
										'<th style="text-align:center; ">Hardware Requirement Specification Document</th>'+
										'<th style="text-align:center; ">Hardware Design Document</th>'+
										'<th style="text-align:center; ">General Document</th>'+
										'<th style="text-align:center; ">Test Suite</th>'+
									'</tr>'+
									'<tbody id=Document-'+projectId+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						
						'<tr id="'+projectId+'Defect Source And Defect Type"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Defect Source And Defect Type statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Defect Source And Defect Type statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Function</th>'+
										'<th style="text-align:center; ">Logical</th>'+
										'<th style="text-align:center; ">Norms</th>'+
										'<th style="text-align:center; ">Interface</th>'+
										'<th style="text-align:center; ">Performance</th>'+
										'<th style="text-align:center; ">Gramer</th>'+
										'<th style="text-align:center; ">Design Defect</th>'+
									'</tr>'+
									'<tbody id=DefectSourceAndDefectType-'+projectId+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						'<tr id="'+projectId+'Defect Origin And TaskPhase"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Defect Origin And TaskPhase statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Defect Origin And TaskPhase statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Open</th>'+
										'<th style="text-align:center; ">Pending</th>'+
										'<th style="text-align:center; ">Closed</th>'+ 
									'</tr>'+
									'<tbody id=DefectOriginAndTaskPhase-'+projectId+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						'<tr id="'+projectId+'Defect State And DefectState"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Defect State And DefectState statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Defect State And DefectState statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Not Delay</th>'+
										'<th style="text-align:center; ">Delay</th>'+ 
									'</tr>'+
									'<tbody id=DefectStateAndDefectState-'+projectId+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+ 
						'<tr id="'+projectId+'Defect ResponsibilityTeam And State"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Defect ResponsibilityTeam And State statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Defect ResponsibilityTeam And State statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Open</th>'+
										'<th style="text-align:center; ">In Analysis</th>'+ 
										'<th style="text-align:center; ">Analyzed</th>'+ 
										'<th style="text-align:center; ">In Progress</th>'+ 
										'<th style="text-align:center; ">InTesting</th>'+ 
										'<th style="text-align:center; ">Verified</th>'+ 
										'<th style="text-align:center; ">Closed</th>'+ 
										'<th style="text-align:center; ">Rejected</th>'+ 
										'<th style="text-align:center; ">Postponed</th>'+ 
									'</tr>'+
									'<tbody id=DefectResponsibilityTeamAndState-'+projectId+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						
						'<tr id="'+projectId+'ChangeRequestType"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>ChangeRequestType statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'ChangeRequestType statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Open</th>'+
										'<th style="text-align:center; ">In Progress</th>'+ 
										'<th style="text-align:center; ">Approveed</th>'+ 
										'<th style="text-align:center; ">Fixed</th>'+ 
										'<th style="text-align:center; ">Closed</th>'+ 
										'<th style="text-align:center; ">Rejected</th>'+ 
										'<th style="text-align:center; ">Cancelled</th>'+ 
										'<th style="text-align:center; ">Postponed</th>'+  
									'</tr>'+
									'<tbody id=ChangeRequestType-'+projectId+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						'<tr id="'+projectId+'ChangeCategory And ChangeInitiator"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>ChangeCategory And ChangeInitiator statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'ChangeCategory And ChangeInitiator statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Customer</th>'+
										'<th style="text-align:center; ">Supplier</th>'+ 
										'<th style="text-align:center; ">Internal</th>'+
									'</tr>'+
									'<tbody id=ChangeCategoryAndChangeInitiator-'+projectId+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						'<tr id="'+projectId+'ChangeOrderType"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>ChangeOrderType statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'ChangeOrderType statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Open</th>'+
										'<th style="text-align:center; ">In Development</th>'+ 
										'<th style="text-align:center; ">Verify</th>'+ 
										'<th style="text-align:center; ">Closed</th>'+ 
									'</tr>'+
									'<tbody id=ChangeOrderType-'+projectId+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						
						'<tr id="'+projectId+'Test Plan"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Test Plan statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Test Plan statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Submit</th>'+
										'<th style="text-align:center; ">In Testing</th>'+ 
										'<th style="text-align:center; ">In Approve</th>'+ 
										'<th style="text-align:center; ">Completed</th>'+ 
										'<th style="text-align:center; ">Delay</th>'+ 
										'<th style="text-align:center; ">Cancelled</th>'+ 
									'</tr>'+
									'<tbody id=TestPlan-'+projectId+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						'<tr id="'+projectId+'Test Objective"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Test Objective statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Test Objective statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Submit</th>'+
										'<th style="text-align:center; ">In Testing</th>'+ 
										'<th style="text-align:center; ">In Approve</th>'+ 
										'<th style="text-align:center; ">Completed</th>'+ 
										'<th style="text-align:center; ">Delay</th>'+ 
										'<th style="text-align:center; ">Cancelled</th>'+ 
									'</tr>'+
									'<tbody id=TestObjective-'+projectId+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						'<tr id="'+projectId+'Test Session"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Test Session statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Test Session statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Submit</th>'+
										'<th style="text-align:center; ">In Testing</th>'+ 
										'<th style="text-align:center; ">In Approve</th>'+ 
										'<th style="text-align:center; ">Completed</th>'+ 
										'<th style="text-align:center; ">Delay</th>'+ 
										'<th style="text-align:center; ">Cancelled</th>'+ 
									'</tr>'+
									'<tbody id=TestSession-'+projectId+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						
						'<tr id="'+projectId+'Task"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Task statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Task statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Open</th>'+
										'<th style="text-align:center; ">In Development</th>'+ 
										'<th style="text-align:center; ">Completed</th>'+ 
										'<th style="text-align:center; ">Cancelled</th>'+
									'</tr>'+
									'<tbody id=Task-'+projectId+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						'<tr id="'+projectId+'Supplier Monitor Task"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Supplier Monitor Task statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Supplier Monitor Task statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Open</th>'+
										'<th style="text-align:center; ">In Progress</th>'+ 
										'<th style="text-align:center; ">In Review</th>'+ 
										'<th style="text-align:center; ">Audit</th>'+
										'<th style="text-align:center; ">Delivered</th>'+
										'<th style="text-align:center; ">Accepted</th>'+
										'<th style="text-align:center; ">Cancelled</th>'+
									'</tr>'+
									'<tbody id=SupplierMonitorTask-'+projectId+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						
						'<tr id="'+projectId+'Release"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Release statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Release statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Open</th>'+
										'<th style="text-align:center; ">In Progress</th>'+ 
										'<th style="text-align:center; ">Audit</th>'+ 
										'<th style="text-align:center; ">In Approve</th>'+
										'<th style="text-align:center; ">Delivered</th>'+
										'<th style="text-align:center; ">Accepted</th>'+
										'<th style="text-align:center; ">Cancelled</th>'+
									'</tr>'+
									'<tbody id=Release-'+projectId+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						
						'<tr id="'+projectId+'Risk"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>Risk  statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'Risk statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Open</th>'+
										'<th style="text-align:center; ">In Analysis</th>'+ 
										'<th style="text-align:center; ">Rejected</th>'+ 
										'<th style="text-align:center; ">Analyzed</th>'+
										'<th style="text-align:center; ">In Monitoring</th>'+
										'<th style="text-align:center; ">Postponed</th>'+
										'<th style="text-align:center; ">Closed</th>'+
									'</tr>'+
									'<tbody id=Risk-'+projectId+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
						
						'<tr id="'+projectId+'LL & BP"  class = "trls">'+
							'<td colspan="2" style="padding: 2px 8px; background-color: #B6CCDD; font-weight: bold; text-align: center">'+
							'<b>LL & BP statistics</b></td>'+
						'</tr>'+
						'<tr>'+
						'<tr id="'+projectId+'LL & BP statistics"  class = "trls">'+
							'<td>'+
								'<table class="detailcols" style="width: 100%;">'+
									'<tr class="even_row" style="width: 100%;">'+ 
										'<th style="text-align:center; width: 30%"></th>'+
										'<th style="text-align:center; ">Open</th>'+
										'<th style="text-align:center; ">In Analysis</th>'+ 
										'<th style="text-align:center; ">Postponed</th>'+ 
										'<th style="text-align:center; ">Rejected</th>'+
										'<th style="text-align:center; ">Accepted</th>'+
										'<th style="text-align:center; ">Published</th>'+
										'<th style="text-align:center; ">Retired</th>'+
									'</tr>'+
									'<tbody id=LLAndBP-'+projectId+'>'+

									'</tbody>'+
								'</table>'+
							'</td>'+
						'</tr>'+
					'</table>'
		
		} 

		document.getElementById("projectDom").innerHTML = html;
		
		//在给需要赋值的dom赋值
		for(var key in CountData){
			var arr = CountData[key];
			var proid = getProjectIdByName(key);
			console.log("proid====== " + proid); 
			console.log("proid----------------"+proid);
			getDate(document.getElementById("QATaskData-"+proid),arr["QATaskData"]);
			getDate(document.getElementById("ReponsibiltyTeam-"+proid),arr["ResponsibilityTeamData"]);
			getDate(document.getElementById("Document-"+proid),arr["DocumentDate"]);

			getDate(document.getElementById("DefectSourceAndDefectType-"+proid),arr["SourceAndType"]);
			getDate(document.getElementById("DefectOriginAndTaskPhase-"+proid),arr["OriginAndTaskPhase"]);
			getDefectStateDate(document.getElementById("DefectStateAndDefectState-"+proid),arr["StateAndDefectState"]);
			getDate(document.getElementById("DefectResponsibilityTeamAndState-"+proid),arr["ResponsibilityTeamAndState"]);
			getDate(document.getElementById("ChangeRequestType-"+proid),arr["ChangeRequestType"]);
			getDate(document.getElementById("ChangeCategoryAndChangeInitiator-"+proid),arr["ChangeCategoryAndChangeInitiator"]);
			getDate(document.getElementById("ChangeOrderType-"+proid),arr["ChangeOrderType"]);
			getDate(document.getElementById("TestPlan-"+proid),arr["TestPlanType"]);
			getDate(document.getElementById("TestObjective-"+proid),arr["TestObjectiveType"]);
			getDate(document.getElementById("TestSession-"+proid),arr["TestSessionType"]);
			getDate(document.getElementById("Task-"+proid),arr["TaskData"]);
			getDate(document.getElementById("SupplierMonitorTask-"+proid),arr["SupplierMonitorTaskData"]);
			getDate(document.getElementById("Release-"+proid),arr["ReleaseData"]);
			getDate(document.getElementById("Risk-"+proid),arr["RiskData"]);
			getDate(document.getElementById("LLAndBP-"+proid),arr["LLAndBPData"]);
		}
		 
	}
	
</script>
</html>
